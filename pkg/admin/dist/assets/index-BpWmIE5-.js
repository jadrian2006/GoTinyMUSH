(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();var ne,C,Ae,H,fe,Me,Oe,Ue,he,ie,oe,Y={},Ie=[],tt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,re=Array.isArray;function N(t,s){for(var n in s)t[n]=s[n];return t}function ue(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function st(t,s,n){var l,i,r,a={};for(r in s)r=="key"?l=s[r]:r=="ref"?i=s[r]:a[r]=s[r];if(arguments.length>2&&(a.children=arguments.length>3?ne.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)a[r]===void 0&&(a[r]=t.defaultProps[r]);return Z(t,a,l,i,null)}function Z(t,s,n,l,i){var r={type:t,props:s,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++Ae,__i:-1,__u:0};return i==null&&C.vnode!=null&&C.vnode(r),r}function W(t){return t.children}function X(t,s){this.props=t,this.context=s}function z(t,s){if(s==null)return t.__?z(t.__,t.__i+1):null;for(var n;s<t.__k.length;s++)if((n=t.__k[s])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?z(t):null}function De(t){var s,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,s=0;s<t.__k.length;s++)if((n=t.__k[s])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return De(t)}}function me(t){(!t.__d&&(t.__d=!0)&&H.push(t)&&!te.__r++||fe!=C.debounceRendering)&&((fe=C.debounceRendering)||Me)(te)}function te(){for(var t,s,n,l,i,r,a,c=1;H.length;)H.length>c&&H.sort(Oe),t=H.shift(),c=H.length,t.__d&&(n=void 0,l=void 0,i=(l=(s=t).__v).__e,r=[],a=[],s.__P&&((n=N({},l)).__v=l.__v+1,C.vnode&&C.vnode(n),pe(s.__P,n,l,s.__n,s.__P.namespaceURI,32&l.__u?[i]:null,r,i??z(l),!!(32&l.__u),a),n.__v=l.__v,n.__.__k[n.__i]=n,je(r,n,a),l.__e=l.__=null,n.__e!=i&&De(n)));te.__r=0}function Re(t,s,n,l,i,r,a,c,h,d,p){var o,_,u,f,k,w,g,S=l&&l.__k||Ie,A=s.length;for(h=nt(n,s,S,h,A),o=0;o<A;o++)(u=n.__k[o])!=null&&(_=u.__i==-1?Y:S[u.__i]||Y,u.__i=o,w=pe(t,u,_,i,r,a,c,h,d,p),f=u.__e,u.ref&&_.ref!=u.ref&&(_.ref&&_e(_.ref,null,u),p.push(u.ref,u.__c||f,u)),k==null&&f!=null&&(k=f),(g=!!(4&u.__u))||_.__k===u.__k?h=Ne(u,h,t,g):typeof u.type=="function"&&w!==void 0?h=w:f&&(h=f.nextSibling),u.__u&=-7);return n.__e=k,h}function nt(t,s,n,l,i){var r,a,c,h,d,p=n.length,o=p,_=0;for(t.__k=new Array(i),r=0;r<i;r++)(a=s[r])!=null&&typeof a!="boolean"&&typeof a!="function"?(typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?a=t.__k[r]=Z(null,a,null,null,null):re(a)?a=t.__k[r]=Z(W,{children:a},null,null,null):a.constructor===void 0&&a.__b>0?a=t.__k[r]=Z(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):t.__k[r]=a,h=r+_,a.__=t,a.__b=t.__b+1,c=null,(d=a.__i=rt(a,n,h,o))!=-1&&(o--,(c=n[d])&&(c.__u|=2)),c==null||c.__v==null?(d==-1&&(i>p?_--:i<p&&_++),typeof a.type!="function"&&(a.__u|=4)):d!=h&&(d==h-1?_--:d==h+1?_++:(d>h?_--:_++,a.__u|=4))):t.__k[r]=null;if(o)for(r=0;r<p;r++)(c=n[r])!=null&&(2&c.__u)==0&&(c.__e==l&&(l=z(c)),Ge(c,c));return l}function Ne(t,s,n,l){var i,r;if(typeof t.type=="function"){for(i=t.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=t,s=Ne(i[r],s,n,l));return s}t.__e!=s&&(l&&(s&&t.type&&!s.parentNode&&(s=z(t)),n.insertBefore(t.__e,s||null)),s=t.__e);do s=s&&s.nextSibling;while(s!=null&&s.nodeType==8);return s}function rt(t,s,n,l){var i,r,a,c=t.key,h=t.type,d=s[n],p=d!=null&&(2&d.__u)==0;if(d===null&&c==null||p&&c==d.key&&h==d.type)return n;if(l>(p?1:0)){for(i=n-1,r=n+1;i>=0||r<s.length;)if((d=s[a=i>=0?i--:r++])!=null&&(2&d.__u)==0&&c==d.key&&h==d.type)return a}return-1}function xe(t,s,n){s[0]=="-"?t.setProperty(s,n??""):t[s]=n==null?"":typeof n!="number"||tt.test(s)?n:n+"px"}function K(t,s,n,l,i){var r,a;e:if(s=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof l=="string"&&(t.style.cssText=l=""),l)for(s in l)n&&s in n||xe(t.style,s,"");if(n)for(s in n)l&&n[s]==l[s]||xe(t.style,s,n[s])}else if(s[0]=="o"&&s[1]=="n")r=s!=(s=s.replace(Ue,"$1")),a=s.toLowerCase(),s=a in t||s=="onFocusOut"||s=="onFocusIn"?a.slice(2):s.slice(2),t.l||(t.l={}),t.l[s+r]=n,n?l?n.u=l.u:(n.u=he,t.addEventListener(s,r?oe:ie,r)):t.removeEventListener(s,r?oe:ie,r);else{if(i=="http://www.w3.org/2000/svg")s=s.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(s!="width"&&s!="height"&&s!="href"&&s!="list"&&s!="form"&&s!="tabIndex"&&s!="download"&&s!="rowSpan"&&s!="colSpan"&&s!="role"&&s!="popover"&&s in t)try{t[s]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&s[4]!="-"?t.removeAttribute(s):t.setAttribute(s,s=="popover"&&n==1?"":n))}}function ge(t){return function(s){if(this.l){var n=this.l[s.type+t];if(s.t==null)s.t=he++;else if(s.t<n.u)return;return n(C.event?C.event(s):s)}}}function pe(t,s,n,l,i,r,a,c,h,d){var p,o,_,u,f,k,w,g,S,A,v,F,T,O,$,G,q,U=s.type;if(s.constructor!==void 0)return null;128&n.__u&&(h=!!(32&n.__u),r=[c=s.__e=n.__e]),(p=C.__b)&&p(s);e:if(typeof U=="function")try{if(g=s.props,S="prototype"in U&&U.prototype.render,A=(p=U.contextType)&&l[p.__c],v=p?A?A.props.value:p.__:l,n.__c?w=(o=s.__c=n.__c).__=o.__E:(S?s.__c=o=new U(g,v):(s.__c=o=new X(g,v),o.constructor=U,o.render=it),A&&A.sub(o),o.state||(o.state={}),o.__n=l,_=o.__d=!0,o.__h=[],o._sb=[]),S&&o.__s==null&&(o.__s=o.state),S&&U.getDerivedStateFromProps!=null&&(o.__s==o.state&&(o.__s=N({},o.__s)),N(o.__s,U.getDerivedStateFromProps(g,o.__s))),u=o.props,f=o.state,o.__v=s,_)S&&U.getDerivedStateFromProps==null&&o.componentWillMount!=null&&o.componentWillMount(),S&&o.componentDidMount!=null&&o.__h.push(o.componentDidMount);else{if(S&&U.getDerivedStateFromProps==null&&g!==u&&o.componentWillReceiveProps!=null&&o.componentWillReceiveProps(g,v),s.__v==n.__v||!o.__e&&o.shouldComponentUpdate!=null&&o.shouldComponentUpdate(g,o.__s,v)===!1){for(s.__v!=n.__v&&(o.props=g,o.state=o.__s,o.__d=!1),s.__e=n.__e,s.__k=n.__k,s.__k.some(function(j){j&&(j.__=s)}),F=0;F<o._sb.length;F++)o.__h.push(o._sb[F]);o._sb=[],o.__h.length&&a.push(o);break e}o.componentWillUpdate!=null&&o.componentWillUpdate(g,o.__s,v),S&&o.componentDidUpdate!=null&&o.__h.push(function(){o.componentDidUpdate(u,f,k)})}if(o.context=v,o.props=g,o.__P=t,o.__e=!1,T=C.__r,O=0,S){for(o.state=o.__s,o.__d=!1,T&&T(s),p=o.render(o.props,o.state,o.context),$=0;$<o._sb.length;$++)o.__h.push(o._sb[$]);o._sb=[]}else do o.__d=!1,T&&T(s),p=o.render(o.props,o.state,o.context),o.state=o.__s;while(o.__d&&++O<25);o.state=o.__s,o.getChildContext!=null&&(l=N(N({},l),o.getChildContext())),S&&!_&&o.getSnapshotBeforeUpdate!=null&&(k=o.getSnapshotBeforeUpdate(u,f)),G=p,p!=null&&p.type===W&&p.key==null&&(G=We(p.props.children)),c=Re(t,re(G)?G:[G],s,n,l,i,r,a,c,h,d),o.base=s.__e,s.__u&=-161,o.__h.length&&a.push(o),w&&(o.__E=o.__=null)}catch(j){if(s.__v=null,h||r!=null)if(j.then){for(s.__u|=h?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;r[r.indexOf(c)]=null,s.__e=c}else{for(q=r.length;q--;)ue(r[q]);ae(s)}else s.__e=n.__e,s.__k=n.__k,j.then||ae(s);C.__e(j,s,n)}else r==null&&s.__v==n.__v?(s.__k=n.__k,s.__e=n.__e):c=s.__e=lt(n.__e,s,n,l,i,r,a,h,d);return(p=C.diffed)&&p(s),128&s.__u?void 0:c}function ae(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(ae)}function je(t,s,n){for(var l=0;l<n.length;l++)_e(n[l],n[++l],n[++l]);C.__c&&C.__c(s,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(r){r.call(i)})}catch(r){C.__e(r,i.__v)}})}function We(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:re(t)?t.map(We):N({},t)}function lt(t,s,n,l,i,r,a,c,h){var d,p,o,_,u,f,k,w=n.props||Y,g=s.props,S=s.type;if(S=="svg"?i="http://www.w3.org/2000/svg":S=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(d=0;d<r.length;d++)if((u=r[d])&&"setAttribute"in u==!!S&&(S?u.localName==S:u.nodeType==3)){t=u,r[d]=null;break}}if(t==null){if(S==null)return document.createTextNode(g);t=document.createElementNS(i,S,g.is&&g),c&&(C.__m&&C.__m(s,r),c=!1),r=null}if(S==null)w===g||c&&t.data==g||(t.data=g);else{if(r=r&&ne.call(t.childNodes),!c&&r!=null)for(w={},d=0;d<t.attributes.length;d++)w[(u=t.attributes[d]).name]=u.value;for(d in w)if(u=w[d],d!="children"){if(d=="dangerouslySetInnerHTML")o=u;else if(!(d in g)){if(d=="value"&&"defaultValue"in g||d=="checked"&&"defaultChecked"in g)continue;K(t,d,null,u,i)}}for(d in g)u=g[d],d=="children"?_=u:d=="dangerouslySetInnerHTML"?p=u:d=="value"?f=u:d=="checked"?k=u:c&&typeof u!="function"||w[d]===u||K(t,d,u,w[d],i);if(p)c||o&&(p.__html==o.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),s.__k=[];else if(o&&(t.innerHTML=""),Re(s.type=="template"?t.content:t,re(_)?_:[_],s,n,l,S=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,a,r?r[0]:n.__k&&z(n,0),c,h),r!=null)for(d=r.length;d--;)ue(r[d]);c||(d="value",S=="progress"&&f==null?t.removeAttribute("value"):f!=null&&(f!==t[d]||S=="progress"&&!f||S=="option"&&f!=w[d])&&K(t,d,f,w[d],i),d="checked",k!=null&&k!=t[d]&&K(t,d,k,w[d],i))}return t}function _e(t,s,n){try{if(typeof t=="function"){var l=typeof t.__u=="function";l&&t.__u(),l&&s==null||(t.__u=t(s))}else t.current=s}catch(i){C.__e(i,n)}}function Ge(t,s,n){var l,i;if(C.unmount&&C.unmount(t),(l=t.ref)&&(l.current&&l.current!=t.__e||_e(l,null,s)),(l=t.__c)!=null){if(l.componentWillUnmount)try{l.componentWillUnmount()}catch(r){C.__e(r,s)}l.base=l.__P=null}if(l=t.__k)for(i=0;i<l.length;i++)l[i]&&Ge(l[i],s,n||typeof t.type!="function");n||ue(t.__e),t.__c=t.__=t.__e=void 0}function it(t,s,n){return this.constructor(t,n)}function ot(t,s,n){var l,i,r,a;s==document&&(s=document.documentElement),C.__&&C.__(t,s),i=(l=!1)?null:s.__k,r=[],a=[],pe(s,t=s.__k=st(W,null,[t]),i||Y,Y,s.namespaceURI,i?null:s.firstChild?ne.call(s.childNodes):null,r,i?i.__e:s.firstChild,l,a),je(r,t,a)}ne=Ie.slice,C={__e:function(t,s,n,l){for(var i,r,a;s=s.__;)if((i=s.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(t)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,l||{}),a=i.__d),a)return i.__E=i}catch(c){t=c}throw t}},Ae=0,X.prototype.setState=function(t,s){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=N({},this.state),typeof t=="function"&&(t=t(N({},n),this.props)),t&&N(n,t),t!=null&&this.__v&&(s&&this._sb.push(s),me(this))},X.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),me(this))},X.prototype.render=W,H=[],Me=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Oe=function(t,s){return t.__v.__b-s.__v.__b},te.__r=0,Ue=/(PointerCapture)$|Capture$/i,he=0,ie=ge(!1),oe=ge(!0);var at=0;function e(t,s,n,l,i,r){s||(s={});var a,c,h=s;if("ref"in h)for(c in h={},s)c=="ref"?a=s[c]:h[c]=s[c];var d={type:t,props:h,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--at,__i:-1,__u:0,__source:i,__self:r};if(typeof t=="function"&&(a=t.defaultProps))for(c in a)h[c]===void 0&&(h[c]=a[c]);return C.vnode&&C.vnode(d),d}var se,L,le,be,ce=0,He=[],E=C,ve=E.__b,ye=E.__r,we=E.diffed,Se=E.__c,ke=E.unmount,Ce=E.__;function ze(t,s){E.__h&&E.__h(L,t,ce||s),ce=0;var n=L.__H||(L.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function m(t){return ce=1,ct(Be,t)}function ct(t,s,n){var l=ze(se++,2);if(l.t=t,!l.__c&&(l.__=[Be(void 0,s),function(c){var h=l.__N?l.__N[0]:l.__[0],d=l.t(h,c);h!==d&&(l.__N=[d,l.__[1]],l.__c.setState({}))}],l.__c=L,!L.__f)){var i=function(c,h,d){if(!l.__c.__H)return!0;var p=l.__c.__H.__.filter(function(_){return!!_.__c});if(p.every(function(_){return!_.__N}))return!r||r.call(this,c,h,d);var o=l.__c.props!==c;return p.forEach(function(_){if(_.__N){var u=_.__[0];_.__=_.__N,_.__N=void 0,u!==_.__[0]&&(o=!0)}}),r&&r.call(this,c,h,d)||o};L.__f=!0;var r=L.shouldComponentUpdate,a=L.componentWillUpdate;L.componentWillUpdate=function(c,h,d){if(this.__e){var p=r;r=void 0,i(c,h,d),r=p}a&&a.call(this,c,h,d)},L.shouldComponentUpdate=i}return l.__N||l.__}function B(t,s){var n=ze(se++,3);!E.__s&&ut(n.__H,s)&&(n.__=t,n.u=s,L.__H.__h.push(n))}function dt(){for(var t;t=He.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(ee),t.__H.__h.forEach(de),t.__H.__h=[]}catch(s){t.__H.__h=[],E.__e(s,t.__v)}}E.__b=function(t){L=null,ve&&ve(t)},E.__=function(t,s){t&&s.__k&&s.__k.__m&&(t.__m=s.__k.__m),Ce&&Ce(t,s)},E.__r=function(t){ye&&ye(t),se=0;var s=(L=t.__c).__H;s&&(le===L?(s.__h=[],L.__h=[],s.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(s.__h.forEach(ee),s.__h.forEach(de),s.__h=[],se=0)),le=L},E.diffed=function(t){we&&we(t);var s=t.__c;s&&s.__H&&(s.__H.__h.length&&(He.push(s)!==1&&be===E.requestAnimationFrame||((be=E.requestAnimationFrame)||ht)(dt)),s.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),le=L=null},E.__c=function(t,s){s.some(function(n){try{n.__h.forEach(ee),n.__h=n.__h.filter(function(l){return!l.__||de(l)})}catch(l){s.some(function(i){i.__h&&(i.__h=[])}),s=[],E.__e(l,n.__v)}}),Se&&Se(t,s)},E.unmount=function(t){ke&&ke(t);var s,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(l){try{ee(l)}catch(i){s=i}}),n.__H=void 0,s&&E.__e(s,n.__v))};var Pe=typeof requestAnimationFrame=="function";function ht(t){var s,n=function(){clearTimeout(l),Pe&&cancelAnimationFrame(s),setTimeout(t)},l=setTimeout(n,35);Pe&&(s=requestAnimationFrame(n))}function ee(t){var s=L,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),L=s}function de(t){var s=L;t.__c=t.__(),L=s}function ut(t,s){return!t||t.length!==s.length||s.some(function(n,l){return n!==t[l]})}function Be(t,s){return typeof s=="function"?s(t):s}const Q={appName:"GoTinyMUSH",tagline:"Modern MUSH Server"},pt=[{page:"dashboard",label:"Dashboard",icon:"⌂"},{page:"import",label:"Import",icon:"⇧"},{page:"config",label:"Config",icon:"⚙"}];function _t({currentPage:t,onNavigate:s,setupMode:n,onLogout:l,children:i}){return e("div",{class:"flex min-h-screen",children:[e("aside",{class:"w-56 bg-slate-800 border-r border-slate-700 flex flex-col",children:[e("div",{class:"p-4 border-b border-slate-700",children:[e("h1",{class:"text-lg font-bold text-indigo-400",children:Q.appName}),e("p",{class:"text-xs text-slate-400",children:Q.tagline})]}),e("nav",{class:"flex-1 p-2",children:pt.map(r=>e("button",{onClick:()=>s(r.page),class:`w-full text-left px-3 py-2 rounded text-sm mb-1 flex items-center gap-2 transition-colors ${t===r.page?"bg-indigo-500/20 text-indigo-300":"text-slate-300 hover:bg-slate-700"}`,children:[e("span",{children:r.icon}),r.label]},r.page))}),n&&e("div",{class:"p-3 m-2 bg-amber-500/10 border border-amber-500/30 rounded text-xs text-amber-300",children:"Setup mode active"}),l&&e("div",{class:"p-2 border-t border-slate-700",children:e("button",{onClick:l,class:"w-full text-left px-3 py-2 rounded text-sm text-slate-400 hover:bg-slate-700 hover:text-slate-300 transition-colors",children:"Logout"})})]}),e("main",{class:"flex-1 p-6 overflow-auto",children:i})]})}const qe="/admin/api";async function P(t,s,n){const l={method:t,headers:{"Content-Type":"application/json"}};n!==void 0&&(l.body=JSON.stringify(n));const i=await fetch(`${qe}${s}`,l);if(!i.ok){const r=await i.json().catch(()=>({error:i.statusText}));throw new Error(r.error||i.statusText)}return i.json()}const y={serverStatus:()=>P("GET","/server/status"),serverStart:()=>P("POST","/server/start"),serverStop:()=>P("POST","/server/stop"),getConfig:()=>P("GET","/config"),putConfig:t=>P("PUT","/config",t),importUpload:t=>P("POST","/import/upload",{path:t}),importUploadFile:async t=>{const s=new FormData;s.append("flatfile",t);const n=await fetch(`${qe}/import/upload`,{method:"POST",body:s});if(!n.ok){const l=await n.json().catch(()=>({error:n.statusText}));throw new Error(l.error||n.statusText)}return n.json()},importValidate:()=>P("POST","/import/validate"),importFindings:()=>P("GET","/import/findings"),importFix:(t,s)=>P("POST","/import/fix",{finding_id:t,category:s}),importCommit:()=>P("POST","/import/commit"),importSession:()=>P("GET","/import/session"),importReset:()=>P("DELETE","/import/session"),importDiscover:()=>P("POST","/import/discover"),importAssign:(t,s)=>P("POST","/import/assign",{path:t,role:s}),importConvertConfig:t=>P("POST","/import/convert-config",{path:t}),importParseComsys:t=>P("POST","/import/parse-comsys",{path:t}),importGetFile:(t,s)=>P("GET",`/import/file/${encodeURIComponent(t)}/${encodeURIComponent(s)}`),importPutFile:(t,s,n)=>P("PUT",`/import/file/${encodeURIComponent(t)}/${encodeURIComponent(s)}`,{content:n}),setupStatus:()=>P("GET","/setup/status"),createNewDB:()=>P("POST","/import/create-new"),serverLaunch:()=>P("POST","/server/launch"),authLogin:t=>P("POST","/auth/login",{password:t}),authLogout:()=>P("POST","/auth/logout"),authStatus:()=>P("GET","/auth/status"),authChangePassword:(t,s)=>P("POST","/auth/change-password",{current:t,new:s})};function Le(){const[t,s]=m(null),[n,l]=m(""),[i,r]=m(!0),[a,c]=m(""),h=()=>{r(!0),y.serverStatus().then(w=>{s(w),l("")}).catch(w=>l(w.message)).finally(()=>r(!1))};B(()=>{h();const w=setInterval(h,5e3);return()=>clearInterval(w)},[]);const d=async()=>{c("");try{await y.serverStart(),h()}catch(w){c(w.message)}},p=async()=>{c("");try{await y.serverStop(),h()}catch(w){c(w.message)}};if(i&&!t)return e("div",{class:"text-slate-400",children:"Loading..."});if(n)return e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-4 text-red-300",children:n});const o=t==null?void 0:t.setup_mode,_=window.location.hostname,u=t==null?void 0:t.connections,f=t==null?void 0:t.queue,k=t==null?void 0:t.memory;return e("div",{children:[e("h2",{class:"text-2xl font-bold mb-6",children:"Dashboard"}),e("div",{class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e(J,{label:"Server Status",value:o?"Setup Mode":t!=null&&t.running?"Running":"Stopped",color:o?"text-amber-400":t!=null&&t.running?"text-green-400":"text-red-400"}),e(J,{label:"Connected Players",value:String((t==null?void 0:t.player_count)??0),color:"text-cyan-400"}),e(J,{label:"Objects",value:String((t==null?void 0:t.object_count)??0),color:"text-indigo-400"}),e(J,{label:"Uptime",value:(t==null?void 0:t.uptime)>0?ft(t.uptime):"-",color:"text-slate-300"})]}),(t==null?void 0:t.running)&&!o&&e("div",{class:"bg-slate-800 rounded p-3 mb-4 flex flex-wrap gap-x-6 gap-y-1 text-sm",children:[t.game_name&&e("span",{children:[e("span",{class:"text-slate-500",children:"Name:"})," ",e("span",{class:"text-slate-200",children:t.game_name})]}),t.version&&e("span",{children:[e("span",{class:"text-slate-500",children:"Version:"})," ",e("span",{class:"text-slate-200",children:t.version})]}),t.port>0&&e("span",{children:[e("span",{class:"text-slate-500",children:"Port:"})," ",e("span",{class:"text-slate-200",children:t.port})]}),t.channels!=null&&e("span",{children:[e("span",{class:"text-slate-500",children:"Channels:"})," ",e("span",{class:"text-slate-200",children:t.channels})]}),t.mail_enabled!=null&&e("span",{children:[e("span",{class:"text-slate-500",children:"Mail:"})," ",e("span",{class:"text-slate-200",children:t.mail_enabled?"Enabled":"Disabled"})]})]}),(t==null?void 0:t.running)&&!o&&(u||f||k)&&e("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[u&&e("div",{class:"bg-slate-800 rounded p-4",children:[e("h3",{class:"text-xs text-slate-400 uppercase tracking-wider mb-2",children:"Connections"}),e("div",{class:"space-y-1 text-sm",children:[e(D,{label:"Total",value:u.total}),e(D,{label:"TCP",value:u.tcp}),e(D,{label:"WebSocket",value:u.websocket}),e(D,{label:"Login Screen",value:u.login_screen}),e(D,{label:"Authenticated",value:u.connected})]})]}),f&&e("div",{class:"bg-slate-800 rounded p-4",children:[e("h3",{class:"text-xs text-slate-400 uppercase tracking-wider mb-2",children:"Command Queue"}),e("div",{class:"space-y-1 text-sm",children:[e(D,{label:"Immediate",value:f.immediate}),e(D,{label:"Waiting",value:f.waiting}),e(D,{label:"Semaphore",value:f.semaphore})]})]}),k&&e("div",{class:"bg-slate-800 rounded p-4",children:[e("h3",{class:"text-xs text-slate-400 uppercase tracking-wider mb-2",children:"Memory"}),e("div",{class:"space-y-1 text-sm",children:[e(D,{label:"Heap",value:`${(k.heap_alloc_mb??0).toFixed(1)} MB`}),e(D,{label:"Goroutines",value:k.goroutines})]})]})]}),a&&e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-3 mb-4 text-red-300 text-sm",children:[a,e("button",{onClick:()=>c(""),class:"ml-2 text-red-400 hover:text-red-300",children:"×"})]}),o&&e("div",{class:"bg-amber-500/10 border border-amber-500/30 rounded p-4 mb-4 text-amber-300 text-sm",children:"The server is in setup mode. Use the Setup wizard or Import page to create or import a game database, then launch the server."}),(t==null?void 0:t.running)&&!o&&e("div",{class:"bg-slate-800 rounded p-4 mb-4",children:[e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-3",children:"How to Connect"}),e("div",{class:"space-y-2 text-sm",children:[e("div",{class:"flex items-start gap-3",children:[e("span",{class:"text-slate-500 w-24 shrink-0",children:"Telnet:"}),e("code",{class:"text-cyan-300 bg-slate-900 px-2 py-0.5 rounded",children:["telnet ",_," ",(t==null?void 0:t.port)||6886]})]}),e("div",{class:"flex items-start gap-3",children:[e("span",{class:"text-slate-500 w-24 shrink-0",children:"MU* Client:"}),e("span",{class:"text-slate-300",children:["Host: ",e("code",{class:"text-cyan-300 bg-slate-900 px-1 rounded",children:_})," Port: ",e("code",{class:"text-cyan-300 bg-slate-900 px-1 rounded",children:(t==null?void 0:t.port)||6886})]})]}),e("div",{class:"flex items-start gap-3",children:[e("span",{class:"text-slate-500 w-24 shrink-0",children:"Web Client:"}),e("a",{href:`http://${_}:8443/`,target:"_blank",class:"text-indigo-400 hover:text-indigo-300",children:["http://",_,":8443/"]})]}),e("div",{class:"mt-3 pt-3 border-t border-slate-700",children:[e("div",{class:"flex items-start gap-3",children:[e("span",{class:"text-slate-500 w-24 shrink-0",children:"God Login:"}),e("span",{class:"text-slate-300",children:e("code",{class:"text-cyan-300 bg-slate-900 px-1 rounded",children:"connect Wizard <password>"})})]}),e("p",{class:"text-slate-500 text-xs mt-1 ml-27",children:"Password is set via MUSH_GODPASS env variable. Change it in-game with: @password <old>=<new>"})]})]})]}),e("div",{class:"flex gap-3",children:[t!=null&&t.running?e("button",{onClick:p,class:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded text-sm transition-colors",children:"Stop Server"}):e("button",{onClick:d,disabled:o,class:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Start Server"}),e("button",{onClick:h,class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-sm transition-colors",children:"Refresh"})]})]})}function J({label:t,value:s,color:n}){return e("div",{class:"bg-slate-800 rounded p-4",children:[e("div",{class:"text-xs text-slate-400 uppercase tracking-wider mb-1",children:t}),e("div",{class:`text-2xl font-bold ${n}`,children:s})]})}function D({label:t,value:s}){return e("div",{class:"flex justify-between",children:[e("span",{class:"text-slate-400",children:t}),e("span",{class:"text-slate-200",children:s})]})}function ft(t){const s=Math.floor(t/86400),n=Math.floor(t%86400/3600),l=Math.floor(t%3600/60),i=Math.floor(t%60);return s>0?`${s}d ${n}h ${l}m`:n>0?`${n}h ${l}m ${i}s`:l>0?`${l}m ${i}s`:`${i}s`}const Te={0:"text-red-400 bg-red-500/10 border-red-500/30",1:"text-amber-400 bg-amber-500/10 border-amber-500/30",2:"text-blue-400 bg-blue-500/10 border-blue-500/30"},mt={0:"ERROR",1:"WARNING",2:"INFO"};function xt({finding:t,onFix:s}){const n=Te[t.severity]||Te[2];return e("div",{class:`border rounded p-3 mb-2 ${n}`,children:[e("div",{class:"flex items-start justify-between gap-2",children:[e("div",{class:"flex-1 min-w-0",children:[e("div",{class:"flex items-center gap-2 mb-1",children:[e("span",{class:"text-xs font-mono opacity-70",children:mt[t.severity]}),e("span",{class:"text-xs font-mono opacity-50",children:["#",t.object_ref]}),t.attr_name&&e("span",{class:"text-xs font-mono opacity-50",children:t.attr_name})]}),e("p",{class:"text-sm",children:t.description})]}),t.fixable&&!t.fixed&&s&&e("button",{onClick:()=>s(t.id),class:"px-2 py-1 bg-green-600 hover:bg-green-500 text-white text-xs rounded shrink-0 transition-colors",children:"Fix"}),t.fixed&&e("span",{class:"text-xs text-green-400 shrink-0",children:"Fixed"})]}),t.current&&e("div",{class:"mt-2",children:[e("div",{class:"text-xs opacity-50 mb-0.5",children:"Current:"}),e("pre",{class:"text-xs font-mono bg-black/20 rounded p-1.5 overflow-x-auto whitespace-pre-wrap break-all",children:t.current})]}),t.proposed&&e("div",{class:"mt-1",children:[e("div",{class:"text-xs opacity-50 mb-0.5",children:"Proposed:"}),e("pre",{class:"text-xs font-mono bg-black/20 rounded p-1.5 overflow-x-auto whitespace-pre-wrap break-all",children:t.proposed})]}),t.effect&&e("div",{class:"mt-1 text-xs opacity-70",children:["Effect: ",t.effect]})]})}const gt={0:"Double-Escaped Brackets",1:"Attribute Flag Anomalies",2:"Escape Sequences",3:"Backslash-Percent Patterns",4:"Integrity Errors",5:"Integrity Warnings"},bt={0:"double-escape",1:"attr-flags",2:"escape-seq",3:"percent",4:"integrity-error",5:"integrity-warning"};function vt({findings:t,onFix:s,onFixAll:n}){const l=new Map;for(const r of t){const a=l.get(r.category)||[];a.push(r),l.set(r.category,a)}const i=Array.from(l.keys()).sort();return e("div",{children:i.map(r=>{const a=l.get(r),c=a.filter(d=>d.fixable&&!d.fixed),h=a.filter(d=>d.fixed);return e("div",{class:"mb-6",children:[e("div",{class:"flex items-center justify-between mb-2",children:[e("h3",{class:"text-lg font-semibold text-slate-200",children:[gt[r]||`Category ${r}`,e("span",{class:"text-sm font-normal text-slate-400 ml-2",children:["(",a.length," total",h.length>0?`, ${h.length} fixed`:"",")"]})]}),c.length>0&&n&&e("button",{onClick:()=>n(bt[r]),class:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-xs rounded transition-colors",children:["Fix All (",c.length,")"]})]}),a.map(d=>e(xt,{finding:d,onFix:s},d.id))]},r)})})}function yt({tabs:t,children:s}){var i;const[n,l]=m(((i=t[0])==null?void 0:i.id)||"");return e("div",{children:[e("div",{class:"flex border-b border-slate-700 mb-4",children:t.map(r=>e("button",{onClick:()=>l(r.id),class:`px-4 py-2 text-sm transition-colors border-b-2 -mb-px ${n===r.id?"border-indigo-500 text-indigo-400":"border-transparent text-slate-400 hover:text-slate-300"}`,children:[r.label,r.badge!==void 0&&e("span",{class:"ml-1.5 px-1.5 py-0.5 text-xs bg-slate-700 rounded-full",children:r.badge})]},r.id))}),s(n)]})}function wt({name:t,role:s,mode:n,initialContent:l,onSave:i}){const[r,a]=m(l||""),[c,h]=m(!1),[d,p]=m(!1),[o,_]=m(""),[u,f]=m(!l);B(()=>{!l&&n==="staged"&&(f(!0),y.importGetFile(s,t).then(g=>a(g.content||"")).catch(g=>_(g.message)).finally(()=>f(!1)))},[t,s]);const k=r.split(`
`).length,w=async()=>{h(!0),p(!1),_("");try{i?i(r):await y.importPutFile(s,t,r),p(!0),setTimeout(()=>p(!1),3e3)}catch(g){_(g.message)}finally{h(!1)}};return u?e("div",{class:"text-slate-400 text-sm",children:["Loading ",t,"..."]}):e("div",{class:"bg-slate-800 rounded p-4",children:[e("div",{class:"flex items-center justify-between mb-2",children:[e("div",{children:[e("span",{class:"text-sm font-mono text-slate-300",children:t}),e("span",{class:"ml-2 text-xs text-slate-500",children:[k," lines"]})]}),e("div",{class:"flex items-center gap-2",children:[d&&e("span",{class:"text-green-400 text-xs",children:"Saved!"}),o&&e("span",{class:"text-red-400 text-xs",children:o}),e("button",{onClick:w,disabled:c,class:"px-3 py-1 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-xs transition-colors disabled:opacity-50",children:c?"Saving...":"Save"})]})]}),e("textarea",{value:r,onInput:g=>a(g.target.value),class:"w-full h-64 px-3 py-2 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 font-mono resize-y focus:outline-none focus:border-indigo-500",spellcheck:!1})]})}function St({name:t,initialContent:s,onSave:n}){const[l,i]=m(s||""),[r,a]=m(!1),[c,h]=m(!1),[d,p]=m(""),[o,_]=m(!s);B(()=>{s||(_(!0),y.importGetFile("alias_config",t).then(f=>i(f.content||"")).catch(f=>p(f.message)).finally(()=>_(!1)))},[t]);const u=async()=>{a(!0),h(!1),p("");try{n?n(l):await y.importPutFile("alias_config",t,l),h(!0),setTimeout(()=>h(!1),3e3)}catch(f){p(f.message)}finally{a(!1)}};return o?e("div",{class:"text-slate-400 text-sm",children:["Loading ",t,"..."]}):e("div",{class:"bg-slate-800 rounded p-4",children:[e("div",{class:"flex items-center justify-between mb-2",children:[e("div",{children:[e("span",{class:"text-sm font-mono text-slate-300",children:t}),e("span",{class:"ml-2 text-xs text-slate-500",children:"YAML alias config"})]}),e("div",{class:"flex items-center gap-2",children:[c&&e("span",{class:"text-green-400 text-xs",children:"Saved!"}),d&&e("span",{class:"text-red-400 text-xs",children:d}),e("button",{onClick:u,disabled:r,class:"px-3 py-1 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-xs transition-colors disabled:opacity-50",children:r?"Saving...":"Save"})]})]}),e("textarea",{value:l,onInput:f=>i(f.target.value),class:"w-full h-80 px-3 py-2 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 font-mono resize-y focus:outline-none focus:border-indigo-500",spellcheck:!1,placeholder:"# YAML alias configuration"})]})}function Ve({mode:t="live",stagedContent:s,onStagedSave:n}){const[l,i]=m(null),[r,a]=m(""),[c,h]=m(""),[d,p]=m(!1),[o,_]=m(!1),[u,f]=m(!1),[k,w]=m("");B(()=>{if(t==="staged"&&s){w(s);try{const v={};for(const F of s.split(`
`)){const T=F.match(/^(\w+):\s*(.*)$/);if(T){const[,O,$]=T;$==="true"?v[O]=!0:$==="false"?v[O]=!1:/^\d+$/.test($)?v[O]=parseInt($):$.startsWith('"')&&$.endsWith('"')?v[O]=$.slice(1,-1):v[O]=$}}Object.keys(v).length>0&&i(v)}catch{f(!0)}return}t==="live"&&y.getConfig().then(v=>{i(v.config),a(v.path)}).catch(v=>h(v.message))},[t,s]);const g=async()=>{p(!0),_(!1),h("");try{t==="staged"?n&&n(k):l&&await y.putConfig(l),_(!0),setTimeout(()=>_(!1),3e3)}catch(v){h(v.message)}finally{p(!1)}},S=(v,F)=>{i(T=>T?{...T,[v]:F}:null)};if(c&&!l&&!k)return e("div",{children:[e("h2",{class:"text-2xl font-bold mb-6",children:"Configuration"}),e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-4 text-red-300",children:c})]});if(!l&&!k)return e("div",{class:"text-slate-400",children:"Loading configuration..."});if(u||t==="staged")return e("div",{children:[e("div",{class:"flex items-center justify-between mb-4",children:[e("div",{children:[e("h2",{class:"text-2xl font-bold",children:t==="staged"?"Config Preview":"Configuration"}),r&&e("p",{class:"text-xs text-slate-400 font-mono",children:r})]}),e("div",{class:"flex items-center gap-3",children:[l&&e("button",{onClick:()=>f(!u),class:"px-3 py-1 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded text-xs transition-colors",children:u?"Structured View":"Raw YAML"}),o&&e("span",{class:"text-green-400 text-sm",children:"Saved!"}),c&&e("span",{class:"text-red-400 text-sm",children:c}),e("button",{onClick:g,disabled:d,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:d?"Saving...":"Save"})]})]}),u||!l?e("textarea",{value:k,onInput:v=>w(v.target.value),class:"w-full h-96 px-3 py-2 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 font-mono resize-y focus:outline-none focus:border-indigo-500",spellcheck:!1}):kt(l,S)]});const A=Qe(l);return e("div",{children:[e("div",{class:"flex items-center justify-between mb-6",children:[e("div",{children:[e("h2",{class:"text-2xl font-bold",children:"Configuration"}),e("p",{class:"text-xs text-slate-400 font-mono",children:r})]}),e("div",{class:"flex items-center gap-3",children:[e("button",{onClick:()=>{const v=Object.entries(l).map(([F,T])=>`${F}: ${JSON.stringify(T)}`).join(`
`);w(v),f(!0)},class:"px-3 py-1 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded text-xs transition-colors",children:"Raw YAML"}),o&&e("span",{class:"text-green-400 text-sm",children:"Saved!"}),c&&e("span",{class:"text-red-400 text-sm",children:c}),e("button",{onClick:g,disabled:d,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:d?"Saving...":"Save"})]})]}),A.map(([v,F])=>e("div",{class:"mb-6",children:[e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-2",children:v}),e("div",{class:"bg-slate-800 rounded p-4 space-y-3",children:F.map(T=>e(Ye,{name:T,value:l[T],onChange:O=>S(T,O)},T))})]},v))]})}function kt(t,s){const n=Qe(t);return e(W,{children:n.map(([l,i])=>e("div",{class:"mb-6",children:[e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-2",children:l}),e("div",{class:"bg-slate-800 rounded p-4 space-y-3",children:i.map(r=>e(Ye,{name:r,value:t[r],onChange:a=>s(r,a)},r))})]},l))})}function Ye({name:t,value:s,onChange:n}){const l=typeof s;return l==="boolean"?e("label",{class:"flex items-center gap-3 cursor-pointer",children:[e("input",{type:"checkbox",checked:s,onChange:i=>n(i.target.checked),class:"w-4 h-4 rounded border-slate-600 text-indigo-600 focus:ring-indigo-500"}),e("span",{class:"text-sm text-slate-300",children:t})]}):l==="number"?e("div",{class:"flex items-center gap-3",children:[e("label",{class:"text-sm text-slate-400 w-48 shrink-0",children:t}),e("input",{type:"number",value:s,onInput:i=>n(Number(i.target.value)),class:"flex-1 px-2 py-1 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 focus:outline-none focus:border-indigo-500"})]}):Array.isArray(s)?e("div",{class:"flex items-start gap-3",children:[e("label",{class:"text-sm text-slate-400 w-48 shrink-0 pt-1",children:t}),e("input",{type:"text",value:s.join(", "),onInput:i=>n(i.target.value.split(",").map(r=>r.trim()).filter(Boolean)),class:"flex-1 px-2 py-1 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 focus:outline-none focus:border-indigo-500",placeholder:"comma-separated values"})]}):e("div",{class:"flex items-center gap-3",children:[e("label",{class:"text-sm text-slate-400 w-48 shrink-0",children:t}),e("input",{type:"text",value:s??"",onInput:i=>n(i.target.value),class:"flex-1 px-2 py-1 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 focus:outline-none focus:border-indigo-500"})]})}function Qe(t){const s={},n={mud_name:"Identity",port:"Identity",master_room:"Rooms",player_starting_room:"Rooms",player_starting_home:"Rooms",default_home:"Rooms",money_name_singular:"Economy",money_name_plural:"Economy",starting_money:"Economy",paycheck:"Economy",earn_limit:"Economy",page_cost:"Economy",wait_cost:"Economy",link_cost:"Economy",idle_timeout:"Idle",idle_wiz_dark:"Idle",queue_idle_chunk:"Queue",function_invocation_limit:"Queue",machine_command_cost:"Queue",output_limit:"Output",web_enabled:"Web",web_port:"Web",web_host:"Web",web_domain:"Web",web_static_dir:"Web",web_cors_origins:"Web",web_rate_limit:"Web",jwt_secret:"Web",jwt_expiry:"Web",guest_char_num:"Guests",guest_prefixes:"Guests",guest_suffixes:"Guests",guest_basename:"Guests",number_guests:"Guests",guest_password:"Guests",guest_start_room:"Guests",mail_enabled:"Modules",comsys_enabled:"Modules",mail_expiration:"Modules",spellcheck_enabled:"Modules",spellcheck_url:"Modules",sql_enabled:"SQL",sql_database:"SQL",sql_query_limit:"SQL",sql_timeout:"SQL",archive_dir:"Backup",archive_interval:"Backup",archive_retain:"Backup",archive_hook:"Backup"};for(const l of Object.keys(t)){const i=n[l]||"Other";s[i]||(s[i]=[]),s[i].push(l)}return Object.entries(s)}const Ee=["upload","discover","configure","summary","resolve","review","committed"],Fe={flatfile:"Flatfile",comsys:"Comsys DB",main_config:"Main Config",alias_config:"Alias Config",text:"Text File",dict:"Dictionary",unknown:"Unknown"},Ct=["flatfile","comsys","main_config","alias_config","text","dict","unknown"],Pt={high:"text-green-400",medium:"text-yellow-400",low:"text-red-400",manual:"text-blue-400"};function Lt(){const[t,s]=m("upload"),[n,l]=m(""),[i,r]=m(!1),[a,c]=m(null),[h,d]=m([]),[p,o]=m(null),[_,u]=m([]),[f,k]=m(""),[w,g]=m(null),[S,A]=m([]),[v,F]=m([]),T=async x=>{var R;const I=(R=x.target.files)==null?void 0:R[0];if(I){r(!0),l("");try{const M=await y.importUploadFile(I);if(c(M),M.source==="foreign_archive"||M.source==="gotinymush_archive"){s("discover");const V=await y.importDiscover();u(V.files||[])}else s("summary")}catch(M){l(M.message)}finally{r(!1)}}},O=async x=>{r(!0),l("");try{const b=await y.importUpload(x);if(c(b),b.source==="foreign_archive"||b.source==="gotinymush_archive"){s("discover");const I=await y.importDiscover();u(I.files||[])}else s("summary")}catch(b){l(b.message)}finally{r(!1)}},$=async(x,b)=>{try{await y.importAssign(x,b),u(I=>I.map(R=>R.path===x?{...R,role:b,confidence:"manual",reason:"manually assigned"}:R))}catch(I){l(I.message)}},G=async()=>{var x;r(!0),l("");try{const b=_.find(M=>M.role==="main_config");if(b)if(((x=b.path.split(".").pop())==null?void 0:x.toLowerCase())==="conf"){const V=await y.importConvertConfig(b.path);k(V.content||"")}else{const V=await y.importGetFile("main_config",b.path.split("/").pop()||"");k(V.content||"")}const I=_.find(M=>M.role==="comsys");if(I){const M=await y.importParseComsys(I.path);g({channels:M.channels||[],alias_count:M.alias_count||0})}const R=await y.importSession();A(R.text_files||[]),F(R.alias_files||[]),s("configure")}catch(b){l(b.message)}finally{r(!1)}},q=()=>{a!=null&&a.object_count||_.some(x=>x.role==="flatfile"),s("summary")},U=async()=>{var x;r(!0),l("");try{const b=await y.importValidate();d(((x=b.report)==null?void 0:x.findings)||[]),o(b.report),s("resolve")}catch(b){l(b.message)}finally{r(!1)}},j=async x=>{try{await y.importFix(x);const b=await y.importFindings();d(b.findings||[]),o(b)}catch(b){l(b.message)}},Ke=async x=>{try{await y.importFix(void 0,x);const b=await y.importFindings();d(b.findings||[]),o(b)}catch(b){l(b.message)}},Je=async()=>{r(!0),l("");try{await y.importCommit(),s("committed")}catch(x){l(x.message)}finally{r(!1)}},Ze=async()=>{try{await y.importReset(),s("upload"),c(null),u([]),k(""),g(null),A([]),F([]),d([]),o(null)}catch(x){l(x.message)}},Xe=async()=>{try{const x=await y.importFindings();d(x.findings||[]),o(x)}catch(x){l(x.message)}},et=(a==null?void 0:a.source)==="flatfile"?Ee.filter(x=>x!=="discover"&&x!=="configure"):Ee;return e("div",{children:[e("div",{class:"flex items-center justify-between mb-6",children:[e("h2",{class:"text-2xl font-bold",children:"Import"}),t!=="upload"&&t!=="committed"&&e("button",{onClick:Ze,class:"px-3 py-1 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded text-xs transition-colors",children:"Start Over"})]}),e("div",{class:"flex items-center gap-2 mb-6 text-sm flex-wrap",children:et.map((x,b)=>e("div",{class:"flex items-center gap-2",children:[b>0&&e("span",{class:"text-slate-600",children:"→"}),e("span",{class:t===x?"text-indigo-400 font-semibold":"text-slate-500",children:x.charAt(0).toUpperCase()+x.slice(1)})]},x))}),n&&e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-3 mb-4 text-red-300 text-sm",children:[n,e("button",{onClick:()=>l(""),class:"ml-2 text-red-400 hover:text-red-300",children:"×"})]}),t==="upload"&&e(Tt,{loading:i,onFileUpload:T,onPathUpload:O}),t==="discover"&&e(Et,{files:_,loading:i,onReassign:$,onConfirm:G}),t==="configure"&&e(Ft,{configContent:f,comsysData:w,textFileNames:S,aliasFileNames:v,onConfigSave:x=>{k(x),y.importPutFile("main_config","config",x).catch(()=>{})},onDone:q}),t==="summary"&&a&&e($t,{result:a,loading:i,onValidate:U,hasExtraFiles:S.length>0||v.length>0||!!f}),t==="resolve"&&e("div",{children:[(p==null?void 0:p.categories)&&e("div",{class:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:Object.entries(p.categories).map(([x,b])=>e("div",{class:"bg-slate-800 rounded p-3",children:[e("div",{class:"text-xs text-slate-400",children:b.label||x}),e("div",{class:"text-lg font-bold text-slate-200",children:b.total}),b.fixed>0&&e("div",{class:"text-xs text-green-400",children:[b.fixed," fixed"]})]},x))}),e(vt,{findings:h,onFix:j,onFixAll:Ke}),e("div",{class:"flex gap-3 mt-4",children:[e("button",{onClick:()=>s("review"),class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors",children:"Review & Commit"}),e("button",{onClick:Xe,class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-sm transition-colors",children:"Refresh"})]})]}),t==="review"&&e("div",{children:[e("h3",{class:"text-lg font-semibold mb-3",children:"Review Changes"}),e("div",{class:"bg-slate-800 rounded p-4 mb-4",children:[e("p",{class:"text-sm text-slate-300",children:[h.filter(x=>x.fixed).length," fixes applied out of ",h.length," total findings."]}),e("p",{class:"text-sm text-slate-400 mt-1",children:[h.filter(x=>x.fixable&&!x.fixed).length," fixable findings remain unapplied."]}),(S.length>0||!!f)&&e("div",{class:"mt-3 pt-3 border-t border-slate-700",children:[e("p",{class:"text-sm text-slate-400",children:"Additional files staged for commit:"}),e("ul",{class:"text-sm text-slate-300 mt-1 list-disc ml-4",children:[f&&e("li",{children:"Game configuration (YAML)"}),S.length>0&&e("li",{children:[S.length," text file(s)"]}),v.length>0&&e("li",{children:[v.length," alias config(s)"]})]})]})]}),e("div",{class:"flex gap-3",children:[e("button",{onClick:Je,disabled:i,class:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:i?"Committing...":"Commit to Database"}),e("button",{onClick:()=>s("resolve"),class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-sm transition-colors",children:"Back to Resolve"})]})]}),t==="committed"&&e(At,{})]})}function Tt({loading:t,onFileUpload:s,onPathUpload:n}){const[l,i]=m("");return e("div",{class:"max-w-lg",children:[e("div",{class:"bg-slate-800 border-2 border-dashed border-slate-600 rounded-lg p-8 text-center mb-4",children:[e("p",{class:"text-slate-400 mb-3",children:"Upload a flatfile, archive (.tar.gz, .zip), or browse"}),e("input",{type:"file",accept:".flat,.FLAT,.gz,.tar.gz,.tgz,.zip",onChange:s,disabled:t,class:"block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:bg-indigo-600 file:text-white hover:file:bg-indigo-500 file:cursor-pointer"})]}),e("div",{class:"text-slate-500 text-center text-sm mb-4",children:"or"}),e("div",{class:"flex gap-2",children:[e("input",{type:"text",placeholder:"Path to file or directory on server...",value:l,onInput:r=>i(r.target.value),class:"flex-1 px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-slate-200 focus:outline-none focus:border-indigo-500"}),e("button",{onClick:()=>l&&n(l),disabled:t||!l,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:t?"Loading...":"Load"})]})]})}function Et({files:t,loading:s,onReassign:n,onConfirm:l}){const i=t.reduce((r,a)=>{const c=a.role;return r[c]=(r[c]||0)+1,r},{});return e("div",{children:[e("h3",{class:"text-lg font-semibold mb-3",children:"Discovered Files"}),e("p",{class:"text-sm text-slate-400 mb-4",children:["Found ",t.length," files. Review role assignments and adjust if needed."]}),e("div",{class:"flex flex-wrap gap-2 mb-4",children:Object.entries(i).map(([r,a])=>e("span",{class:"px-2 py-1 bg-slate-800 rounded text-xs text-slate-300",children:[Fe[r]||r,": ",a]},r))}),e("div",{class:"bg-slate-800 rounded overflow-hidden mb-4",children:e("table",{class:"w-full text-sm",children:[e("thead",{children:e("tr",{class:"border-b border-slate-700",children:[e("th",{class:"text-left px-3 py-2 text-slate-400 font-medium",children:"File"}),e("th",{class:"text-left px-3 py-2 text-slate-400 font-medium w-40",children:"Role"}),e("th",{class:"text-center px-3 py-2 text-slate-400 font-medium w-16",children:"Conf."}),e("th",{class:"text-right px-3 py-2 text-slate-400 font-medium w-20",children:"Size"})]})}),e("tbody",{children:t.map(r=>e("tr",{class:"border-b border-slate-700/50 hover:bg-slate-750",children:[e("td",{class:"px-3 py-2",children:[e("div",{class:"font-mono text-slate-300 text-xs",children:r.path}),e("div",{class:"text-xs text-slate-500 mt-0.5",children:r.reason})]}),e("td",{class:"px-3 py-2",children:e("select",{value:r.role,onChange:a=>n(r.path,a.target.value),class:"w-full px-2 py-1 bg-slate-900 border border-slate-600 rounded text-xs text-slate-300 focus:outline-none focus:border-indigo-500",children:Ct.map(a=>e("option",{value:a,children:Fe[a]},a))})}),e("td",{class:"px-3 py-2 text-center",children:e("span",{class:`text-lg ${Pt[r.confidence]||"text-slate-500"}`,title:r.confidence,children:"●"})}),e("td",{class:"px-3 py-2 text-right text-slate-400 text-xs font-mono",children:Mt(r.size)})]},r.path))})]})}),e("button",{onClick:l,disabled:s,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:s?"Processing...":"Confirm & Continue"})]})}function Ft({configContent:t,comsysData:s,textFileNames:n,aliasFileNames:l,onConfigSave:i,onDone:r}){const a=[];return t&&a.push({id:"config",label:"Config"}),l.length>0&&a.push({id:"aliases",label:"Aliases",badge:l.length}),n.length>0&&a.push({id:"text",label:"Text Files",badge:n.length}),s&&a.push({id:"comsys",label:"Comsys"}),a.length===0?e("div",{children:[e("p",{class:"text-slate-400 mb-4",children:"No additional files to configure."}),e("button",{onClick:r,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors",children:"Continue to Summary"})]}):e("div",{children:[e("h3",{class:"text-lg font-semibold mb-3",children:"Configure Files"}),e("p",{class:"text-sm text-slate-400 mb-4",children:"Review and edit staged files before committing."}),e(yt,{tabs:a,children:c=>e(W,{children:[c==="config"&&e(Ve,{mode:"staged",stagedContent:t,onStagedSave:i}),c==="aliases"&&e("div",{class:"space-y-4",children:l.map(h=>e(St,{name:h},h))}),c==="text"&&e("div",{class:"space-y-4",children:n.map(h=>e(wt,{name:h,role:"text",mode:"staged"},h))}),c==="comsys"&&s&&e("div",{class:"bg-slate-800 rounded p-4",children:[e("div",{class:"grid grid-cols-2 gap-4 mb-4",children:[e("div",{children:[e("span",{class:"text-xs text-slate-400",children:"Channels"}),e("div",{class:"text-lg font-bold text-slate-200",children:s.channels.length})]}),e("div",{children:[e("span",{class:"text-xs text-slate-400",children:"Player Aliases"}),e("div",{class:"text-lg font-bold text-slate-200",children:s.alias_count})]})]}),s.channels.length>0&&e("table",{class:"w-full text-sm",children:[e("thead",{children:e("tr",{class:"border-b border-slate-700",children:[e("th",{class:"text-left px-2 py-1 text-slate-400",children:"Channel"}),e("th",{class:"text-left px-2 py-1 text-slate-400",children:"Owner"}),e("th",{class:"text-left px-2 py-1 text-slate-400",children:"Description"}),e("th",{class:"text-right px-2 py-1 text-slate-400",children:"Messages"})]})}),e("tbody",{children:s.channels.map(h=>e("tr",{class:"border-b border-slate-700/50",children:[e("td",{class:"px-2 py-1 text-slate-300 font-mono",children:h.name}),e("td",{class:"px-2 py-1 text-slate-400",children:["#",h.owner]}),e("td",{class:"px-2 py-1 text-slate-400 truncate max-w-xs",children:h.description}),e("td",{class:"px-2 py-1 text-slate-400 text-right",children:h.num_sent})]},h.name))})]})]})]})}),e("div",{class:"mt-4",children:e("button",{onClick:r,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors",children:"Continue to Summary"})})]})}function $t({result:t,loading:s,onValidate:n,hasExtraFiles:l}){return e("div",{children:[e("h3",{class:"text-lg font-semibold mb-3",children:"Import Summary"}),e("div",{class:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[e("div",{class:"bg-slate-800 rounded p-3",children:[e("div",{class:"text-xs text-slate-400",children:"Objects"}),e("div",{class:"text-xl font-bold text-slate-200",children:t.object_count??0})]}),e("div",{class:"bg-slate-800 rounded p-3",children:[e("div",{class:"text-xs text-slate-400",children:"Attr Definitions"}),e("div",{class:"text-xl font-bold text-slate-200",children:t.attr_defs??0})]}),e("div",{class:"bg-slate-800 rounded p-3",children:[e("div",{class:"text-xs text-slate-400",children:"Total Attributes"}),e("div",{class:"text-xl font-bold text-slate-200",children:t.total_attrs??0})]}),e("div",{class:"bg-slate-800 rounded p-3",children:[e("div",{class:"text-xs text-slate-400",children:"Source"}),e("div",{class:"text-sm font-mono text-slate-200 truncate",children:t.source||t.file})]})]}),t.type_counts&&e("div",{class:"bg-slate-800 rounded p-4 mb-4",children:[e("h4",{class:"text-sm text-slate-400 mb-2",children:"Object Types"}),e("div",{class:"grid grid-cols-3 md:grid-cols-6 gap-2",children:Object.entries(t.type_counts).map(([i,r])=>e("div",{children:[e("span",{class:"text-xs text-slate-500",children:[i,": "]}),e("span",{class:"text-sm text-slate-200",children:r})]},i))})]}),l&&e("div",{class:"bg-slate-800/50 rounded p-3 mb-4 text-sm text-slate-400",children:"Additional files (config, text, aliases) are staged and will be committed with the database."}),e("button",{onClick:n,disabled:s,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:s?"Validating...":"Run Validation"})]})}function At(){const[t,s]=m(!1),[n,l]=m(""),i=async()=>{s(!0),l("");try{await y.serverLaunch()}catch{}let a=0;const c=setInterval(async()=>{a++;try{await y.serverStatus(),clearInterval(c),window.location.reload()}catch{a>30&&(clearInterval(c),l("Server did not come back after restart. Check Docker logs."),s(!1))}},2e3)};if(t)return e("div",{class:"text-center py-12",children:[e("div",{class:"inline-block w-8 h-8 border-4 border-indigo-400 border-t-transparent rounded-full animate-spin mb-4"}),e("h3",{class:"text-xl font-semibold mb-2",children:"Launching Server..."}),e("p",{class:"text-slate-400",children:"The server is restarting with your imported database."})]});const r=window.location.hostname;return e("div",{class:"text-center py-12",children:[e("div",{class:"text-4xl mb-4 text-green-400",children:"✓"}),e("h3",{class:"text-xl font-semibold mb-2",children:"Database Committed"}),e("p",{class:"text-slate-400 mb-6",children:"The database has been written to disk and is ready to go."}),n&&e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-3 mb-4 text-red-300 text-sm inline-block",children:n}),e("div",{class:"mb-6",children:e("button",{onClick:i,class:"px-6 py-2 bg-green-600 hover:bg-green-500 text-white rounded transition-colors",children:"Launch Server"})}),e("div",{class:"bg-slate-800 rounded p-4 text-left max-w-md mx-auto text-sm",children:[e("h4",{class:"text-slate-400 text-xs uppercase tracking-wider mb-2",children:"After launch, connect via:"}),e("div",{class:"space-y-1",children:[e("div",{children:[e("span",{class:"text-slate-500",children:"Telnet:"})," ",e("code",{class:"text-cyan-300",children:["telnet ",r," 6886"]})]}),e("div",{children:[e("span",{class:"text-slate-500",children:"MU* Client:"})," ",e("span",{class:"text-slate-300",children:[r," port 6886"]})]}),e("div",{children:[e("span",{class:"text-slate-500",children:"God Login:"})," ",e("code",{class:"text-cyan-300",children:"connect Wizard <password>"})]}),e("p",{class:"text-slate-500 text-xs mt-2",children:"Password set via MUSH_GODPASS env variable."})]})]})]})}function Mt(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`}function Ot({onComplete:t}){const[s,n]=m("welcome"),[l,i]=m(""),[r,a]=m(!1),[c,h]=m(!1),d=async()=>{a(!0),i("");try{await y.createNewDB(),h(!0),n("ready")}catch(u){i(u.message)}finally{a(!1)}},p=async()=>{n("launching"),i("");try{await y.serverLaunch(),setTimeout(()=>o(),2e3)}catch{setTimeout(()=>o(),2e3)}},o=()=>{let u=0;const f=setInterval(async()=>{u++;try{await y.serverStatus()&&(clearInterval(f),t())}catch{u>30&&(clearInterval(f),i("Server did not come back after restart. Check Docker logs."),n("ready"))}},2e3)},_=["welcome","config","database","ready"];return e("div",{class:"max-w-2xl mx-auto",children:[e("div",{class:"text-center mb-8",children:[e("h1",{class:"text-3xl font-bold text-indigo-400 mb-2",children:Q.appName}),e("p",{class:"text-slate-400",children:"Setup Wizard"})]}),e("div",{class:"flex items-center justify-center gap-4 mb-8",children:_.map((u,f)=>e("div",{class:"flex items-center gap-2",children:[f>0&&e("div",{class:"w-8 h-px bg-slate-600"}),e("div",{class:`w-8 h-8 rounded-full flex items-center justify-center text-sm ${s===u||s==="launching"&&u==="ready"?"bg-indigo-600 text-white":$e(s)>f?"bg-green-600 text-white":"bg-slate-700 text-slate-400"}`,children:$e(s)>f?"✓":f+1})]},u))}),l&&e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-3 mb-4 text-red-300 text-sm",children:[l,e("button",{onClick:()=>i(""),class:"ml-2 text-red-400 hover:text-red-300",children:"×"})]}),s==="welcome"&&e("div",{class:"bg-slate-800 rounded-lg p-8 text-center",children:[e("h2",{class:"text-xl font-semibold mb-4",children:["Welcome to ",Q.appName]}),e("p",{class:"text-slate-400 mb-6",children:"This wizard will help you configure your MUSH server and set up your game database."}),e("button",{onClick:()=>n("config"),class:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded transition-colors",children:"Get Started"})]}),s==="config"&&e("div",{class:"bg-slate-800 rounded-lg p-8",children:[e("h2",{class:"text-xl font-semibold mb-4",children:"Configuration"}),e("p",{class:"text-slate-400 mb-4",children:"Your game configuration (game.yaml) contains server settings like port, name, and features. A default configuration will be created automatically. You can customize it later from the Config page."}),e("div",{class:"flex gap-3",children:[e("button",{onClick:()=>n("database"),class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors",children:"Continue"}),e("button",{onClick:()=>n("database"),class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-sm transition-colors",children:"Skip"})]})]}),s==="database"&&e("div",{class:"bg-slate-800 rounded-lg p-8",children:[e("h2",{class:"text-xl font-semibold mb-4",children:"Game Database"}),e("p",{class:"text-slate-400 mb-6",children:"Choose how to set up your game database:"}),e("div",{class:"space-y-3 mb-6",children:[e("button",{onClick:d,disabled:r,class:"w-full text-left p-4 bg-indigo-600/20 border border-indigo-500/40 rounded-lg hover:bg-indigo-600/30 transition-colors disabled:opacity-50",children:[e("div",{class:"text-indigo-300 font-semibold mb-1",children:r?"Creating...":"New Database (Recommended)"}),e("div",{class:"text-slate-400 text-sm",children:"Start fresh with an empty world. Creates Room Zero, Master Room, and the God (Wizard) player."})]}),e("button",{onClick:()=>{n("ready")},class:"w-full text-left p-4 bg-slate-700/50 border border-slate-600 rounded-lg hover:bg-slate-700 transition-colors",children:[e("div",{class:"text-slate-200 font-semibold mb-1",children:"Import from Backup"}),e("div",{class:"text-slate-400 text-sm",children:"Upload a TinyMUSH flatfile (.FLAT) or archive (.tar.gz, .zip) with your existing game data. Use the Import page from the sidebar after setup."})]})]})]}),s==="ready"&&e("div",{class:"bg-slate-800 rounded-lg p-8",children:c?e(W,{children:[e("div",{class:"text-center",children:[e("div",{class:"text-4xl mb-4 text-green-400",children:"✓"}),e("h2",{class:"text-xl font-semibold mb-2",children:"Database Created"}),e("p",{class:"text-slate-400 mb-6",children:"Your new game world is ready with Room Zero, Master Room, and the Wizard player. Seed files (text, dict, config, aliases) have been copied to the data directory."})]}),e("div",{class:"bg-slate-900 rounded p-4 mb-6 text-sm",children:[e("h4",{class:"text-slate-400 text-xs uppercase tracking-wider mb-2",children:"After Launch"}),e("div",{class:"space-y-1 text-slate-300",children:[e("div",{children:[e("span",{class:"text-slate-500",children:"Telnet:"})," ",e("code",{class:"text-cyan-300",children:["telnet ",window.location.hostname," 6886"]})]}),e("div",{children:[e("span",{class:"text-slate-500",children:"MU* Client:"})," ",window.location.hostname," port 6886"]}),e("div",{children:[e("span",{class:"text-slate-500",children:"Web Client:"})," ",e("code",{class:"text-cyan-300",children:["http://",window.location.hostname,":8443/"]})]}),e("div",{class:"mt-2 pt-2 border-t border-slate-700",children:[e("span",{class:"text-slate-500",children:"God Login:"})," ",e("code",{class:"text-cyan-300",children:"connect Wizard <password>"})]}),e("p",{class:"text-slate-500 text-xs mt-1",children:["God password is set via MUSH_GODPASS in docker-compose.yml. Change it in-game: ",e("code",{children:"@password <old>=<new>"})]})]})]}),e("div",{class:"flex gap-3 justify-center",children:[e("button",{onClick:p,class:"px-6 py-2 bg-green-600 hover:bg-green-500 text-white rounded transition-colors",children:"Launch Server"}),e("button",{onClick:t,class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-sm transition-colors",children:"Go to Dashboard First"})]})]}):e(W,{children:e("div",{class:"text-center",children:[e("h2",{class:"text-xl font-semibold mb-4",children:"Setup Complete"}),e("p",{class:"text-slate-400 mb-6",children:"You can import a game database from the Import page, or create a new one. Use the sidebar to navigate to the Import page when ready."}),e("button",{onClick:t,class:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded transition-colors",children:"Go to Dashboard"})]})})}),s==="launching"&&e("div",{class:"bg-slate-800 rounded-lg p-8 text-center",children:[e("div",{class:"mb-4",children:e("div",{class:"inline-block w-8 h-8 border-4 border-indigo-400 border-t-transparent rounded-full animate-spin"})}),e("h2",{class:"text-xl font-semibold mb-4",children:"Launching Server..."}),e("p",{class:"text-slate-400",children:"The server is restarting with your new database. This may take a few seconds."})]})]})}function $e(t){return["welcome","config","database","ready"].indexOf(t)}function Ut({onLogin:t}){const[s,n]=m(""),[l,i]=m(""),[r,a]=m(!1),c=async h=>{h.preventDefault(),a(!0),i("");try{const d=await y.authLogin(s);t(d.default_password)}catch(d){i(d.message||"Login failed")}finally{a(!1)}};return e("div",{class:"min-h-screen flex items-center justify-center bg-slate-900",children:e("div",{class:"bg-slate-800 rounded-lg p-8 w-full max-w-sm",children:[e("div",{class:"text-center mb-6",children:[e("h1",{class:"text-2xl font-bold text-indigo-400",children:Q.appName}),e("p",{class:"text-sm text-slate-400 mt-1",children:"Admin Panel"})]}),e("form",{onSubmit:c,children:[e("div",{class:"mb-4",children:[e("label",{class:"block text-sm text-slate-400 mb-1",children:"Password"}),e("input",{type:"password",value:s,onInput:h=>n(h.target.value),class:"w-full px-3 py-2 bg-slate-900 border border-slate-600 rounded text-slate-200 focus:outline-none focus:border-indigo-500",placeholder:"Enter admin password",autoFocus:!0})]}),l&&e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-2 mb-4 text-red-300 text-sm",children:l}),e("button",{type:"submit",disabled:r||!s,class:"w-full px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:r?"Logging in...":"Login"})]}),e("p",{class:"text-xs text-slate-500 text-center mt-4",children:"Default password: goTinyMush"})]})})}function It(){const[t,s]=m("dashboard"),[n,l]=m(!1),[i,r]=m(null),[a,c]=m(!1);B(()=>{y.authStatus().then(o=>{r(o.authenticated),o.authenticated&&o.default_password&&c(!0)}).catch(()=>r(!1))},[]),B(()=>{i&&y.setupStatus().then(o=>{o.setup_mode&&(l(!0),s("setup"))}).catch(()=>{})},[i]);const h=o=>{r(!0),o&&c(!0)},d=async()=>{await y.authLogout().catch(()=>{}),r(!1)};return i===null?e("div",{class:"min-h-screen flex items-center justify-center bg-slate-900 text-slate-400",children:"Loading..."}):i?e(_t,{currentPage:t,onNavigate:s,setupMode:n,onLogout:d,children:[a&&e("div",{class:"bg-amber-500/10 border border-amber-500/30 rounded p-3 mb-4 text-amber-300 text-sm flex items-center justify-between",children:[e("span",{children:"You are using the default admin password. Change it in the admin settings for security."}),e("button",{onClick:()=>c(!1),class:"text-amber-400 hover:text-amber-300 ml-2",children:"×"})]}),(()=>{switch(t){case"dashboard":return e(Le,{});case"import":return e(Lt,{});case"config":return e(Ve,{});case"setup":return e(Ot,{onComplete:()=>{l(!1),s("dashboard")}});default:return e(Le,{})}})()]}):e(Ut,{onLogin:h})}ot(e(It,{}),document.getElementById("app"));

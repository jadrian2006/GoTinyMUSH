(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();var ie,k,De,W,ge,je,Ne,Re,_e,ce,de,Q={},He=[],it=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ae=Array.isArray;function R(t,s){for(var n in s)t[n]=s[n];return t}function me(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function at(t,s,n){var l,i,r,o={};for(r in s)r=="key"?l=s[r]:r=="ref"?i=s[r]:o[r]=s[r];if(arguments.length>2&&(o.children=arguments.length>3?ie.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)o[r]===void 0&&(o[r]=t.defaultProps[r]);return ee(t,o,l,i,null)}function ee(t,s,n,l,i){var r={type:t,props:s,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++De,__i:-1,__u:0};return i==null&&k.vnode!=null&&k.vnode(r),r}function j(t){return t.children}function te(t,s){this.props=t,this.context=s}function z(t,s){if(s==null)return t.__?z(t.__,t.__i+1):null;for(var n;s<t.__k.length;s++)if((n=t.__k[s])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?z(t):null}function Ge(t){var s,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,s=0;s<t.__k.length;s++)if((n=t.__k[s])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Ge(t)}}function be(t){(!t.__d&&(t.__d=!0)&&W.push(t)&&!re.__r++||ge!=k.debounceRendering)&&((ge=k.debounceRendering)||je)(re)}function re(){for(var t,s,n,l,i,r,o,c=1;W.length;)W.length>c&&W.sort(Ne),t=W.shift(),c=W.length,t.__d&&(n=void 0,l=void 0,i=(l=(s=t).__v).__e,r=[],o=[],s.__P&&((n=R({},l)).__v=l.__v+1,k.vnode&&k.vnode(n),fe(s.__P,n,l,s.__n,s.__P.namespaceURI,32&l.__u?[i]:null,r,i??z(l),!!(32&l.__u),o),n.__v=l.__v,n.__.__k[n.__i]=n,Be(r,n,o),l.__e=l.__=null,n.__e!=i&&Ge(n)));re.__r=0}function We(t,s,n,l,i,r,o,c,h,d,p){var a,_,u,m,C,v,b,S=l&&l.__k||He,M=s.length;for(h=ot(n,s,S,h,M),a=0;a<M;a++)(u=n.__k[a])!=null&&(_=u.__i==-1?Q:S[u.__i]||Q,u.__i=a,v=fe(t,u,_,i,r,o,c,h,d,p),m=u.__e,u.ref&&_.ref!=u.ref&&(_.ref&&xe(_.ref,null,u),p.push(u.ref,u.__c||m,u)),C==null&&m!=null&&(C=m),(b=!!(4&u.__u))||_.__k===u.__k?h=ze(u,h,t,b):typeof u.type=="function"&&v!==void 0?h=v:m&&(h=m.nextSibling),u.__u&=-7);return n.__e=C,h}function ot(t,s,n,l,i){var r,o,c,h,d,p=n.length,a=p,_=0;for(t.__k=new Array(i),r=0;r<i;r++)(o=s[r])!=null&&typeof o!="boolean"&&typeof o!="function"?(typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?o=t.__k[r]=ee(null,o,null,null,null):ae(o)?o=t.__k[r]=ee(j,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?o=t.__k[r]=ee(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):t.__k[r]=o,h=r+_,o.__=t,o.__b=t.__b+1,c=null,(d=o.__i=ct(o,n,h,a))!=-1&&(a--,(c=n[d])&&(c.__u|=2)),c==null||c.__v==null?(d==-1&&(i>p?_--:i<p&&_++),typeof o.type!="function"&&(o.__u|=4)):d!=h&&(d==h-1?_--:d==h+1?_++:(d>h?_--:_++,o.__u|=4))):t.__k[r]=null;if(a)for(r=0;r<p;r++)(c=n[r])!=null&&(2&c.__u)==0&&(c.__e==l&&(l=z(c)),Ye(c,c));return l}function ze(t,s,n,l){var i,r;if(typeof t.type=="function"){for(i=t.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=t,s=ze(i[r],s,n,l));return s}t.__e!=s&&(l&&(s&&t.type&&!s.parentNode&&(s=z(t)),n.insertBefore(t.__e,s||null)),s=t.__e);do s=s&&s.nextSibling;while(s!=null&&s.nodeType==8);return s}function ct(t,s,n,l){var i,r,o,c=t.key,h=t.type,d=s[n],p=d!=null&&(2&d.__u)==0;if(d===null&&c==null||p&&c==d.key&&h==d.type)return n;if(l>(p?1:0)){for(i=n-1,r=n+1;i>=0||r<s.length;)if((d=s[o=i>=0?i--:r++])!=null&&(2&d.__u)==0&&c==d.key&&h==d.type)return o}return-1}function ve(t,s,n){s[0]=="-"?t.setProperty(s,n??""):t[s]=n==null?"":typeof n!="number"||it.test(s)?n:n+"px"}function Z(t,s,n,l,i){var r,o;e:if(s=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof l=="string"&&(t.style.cssText=l=""),l)for(s in l)n&&s in n||ve(t.style,s,"");if(n)for(s in n)l&&n[s]==l[s]||ve(t.style,s,n[s])}else if(s[0]=="o"&&s[1]=="n")r=s!=(s=s.replace(Re,"$1")),o=s.toLowerCase(),s=o in t||s=="onFocusOut"||s=="onFocusIn"?o.slice(2):s.slice(2),t.l||(t.l={}),t.l[s+r]=n,n?l?n.u=l.u:(n.u=_e,t.addEventListener(s,r?de:ce,r)):t.removeEventListener(s,r?de:ce,r);else{if(i=="http://www.w3.org/2000/svg")s=s.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(s!="width"&&s!="height"&&s!="href"&&s!="list"&&s!="form"&&s!="tabIndex"&&s!="download"&&s!="rowSpan"&&s!="colSpan"&&s!="role"&&s!="popover"&&s in t)try{t[s]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&s[4]!="-"?t.removeAttribute(s):t.setAttribute(s,s=="popover"&&n==1?"":n))}}function ye(t){return function(s){if(this.l){var n=this.l[s.type+t];if(s.t==null)s.t=_e++;else if(s.t<n.u)return;return n(k.event?k.event(s):s)}}}function fe(t,s,n,l,i,r,o,c,h,d){var p,a,_,u,m,C,v,b,S,M,y,$,L,U,F,G,q,I=s.type;if(s.constructor!==void 0)return null;128&n.__u&&(h=!!(32&n.__u),r=[c=s.__e=n.__e]),(p=k.__b)&&p(s);e:if(typeof I=="function")try{if(b=s.props,S="prototype"in I&&I.prototype.render,M=(p=I.contextType)&&l[p.__c],y=p?M?M.props.value:p.__:l,n.__c?v=(a=s.__c=n.__c).__=a.__E:(S?s.__c=a=new I(b,y):(s.__c=a=new te(b,y),a.constructor=I,a.render=ht),M&&M.sub(a),a.state||(a.state={}),a.__n=l,_=a.__d=!0,a.__h=[],a._sb=[]),S&&a.__s==null&&(a.__s=a.state),S&&I.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=R({},a.__s)),R(a.__s,I.getDerivedStateFromProps(b,a.__s))),u=a.props,m=a.state,a.__v=s,_)S&&I.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),S&&a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(S&&I.getDerivedStateFromProps==null&&b!==u&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(b,y),s.__v==n.__v||!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(b,a.__s,y)===!1){for(s.__v!=n.__v&&(a.props=b,a.state=a.__s,a.__d=!1),s.__e=n.__e,s.__k=n.__k,s.__k.some(function(H){H&&(H.__=s)}),$=0;$<a._sb.length;$++)a.__h.push(a._sb[$]);a._sb=[],a.__h.length&&o.push(a);break e}a.componentWillUpdate!=null&&a.componentWillUpdate(b,a.__s,y),S&&a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(u,m,C)})}if(a.context=y,a.props=b,a.__P=t,a.__e=!1,L=k.__r,U=0,S){for(a.state=a.__s,a.__d=!1,L&&L(s),p=a.render(a.props,a.state,a.context),F=0;F<a._sb.length;F++)a.__h.push(a._sb[F]);a._sb=[]}else do a.__d=!1,L&&L(s),p=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++U<25);a.state=a.__s,a.getChildContext!=null&&(l=R(R({},l),a.getChildContext())),S&&!_&&a.getSnapshotBeforeUpdate!=null&&(C=a.getSnapshotBeforeUpdate(u,m)),G=p,p!=null&&p.type===j&&p.key==null&&(G=qe(p.props.children)),c=We(t,ae(G)?G:[G],s,n,l,i,r,o,c,h,d),a.base=s.__e,s.__u&=-161,a.__h.length&&o.push(a),v&&(a.__E=a.__=null)}catch(H){if(s.__v=null,h||r!=null)if(H.then){for(s.__u|=h?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;r[r.indexOf(c)]=null,s.__e=c}else{for(q=r.length;q--;)me(r[q]);he(s)}else s.__e=n.__e,s.__k=n.__k,H.then||he(s);k.__e(H,s,n)}else r==null&&s.__v==n.__v?(s.__k=n.__k,s.__e=n.__e):c=s.__e=dt(n.__e,s,n,l,i,r,o,h,d);return(p=k.diffed)&&p(s),128&s.__u?void 0:c}function he(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(he)}function Be(t,s,n){for(var l=0;l<n.length;l++)xe(n[l],n[++l],n[++l]);k.__c&&k.__c(s,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(r){r.call(i)})}catch(r){k.__e(r,i.__v)}})}function qe(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:ae(t)?t.map(qe):R({},t)}function dt(t,s,n,l,i,r,o,c,h){var d,p,a,_,u,m,C,v=n.props||Q,b=s.props,S=s.type;if(S=="svg"?i="http://www.w3.org/2000/svg":S=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(d=0;d<r.length;d++)if((u=r[d])&&"setAttribute"in u==!!S&&(S?u.localName==S:u.nodeType==3)){t=u,r[d]=null;break}}if(t==null){if(S==null)return document.createTextNode(b);t=document.createElementNS(i,S,b.is&&b),c&&(k.__m&&k.__m(s,r),c=!1),r=null}if(S==null)v===b||c&&t.data==b||(t.data=b);else{if(r=r&&ie.call(t.childNodes),!c&&r!=null)for(v={},d=0;d<t.attributes.length;d++)v[(u=t.attributes[d]).name]=u.value;for(d in v)if(u=v[d],d!="children"){if(d=="dangerouslySetInnerHTML")a=u;else if(!(d in b)){if(d=="value"&&"defaultValue"in b||d=="checked"&&"defaultChecked"in b)continue;Z(t,d,null,u,i)}}for(d in b)u=b[d],d=="children"?_=u:d=="dangerouslySetInnerHTML"?p=u:d=="value"?m=u:d=="checked"?C=u:c&&typeof u!="function"||v[d]===u||Z(t,d,u,v[d],i);if(p)c||a&&(p.__html==a.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),s.__k=[];else if(a&&(t.innerHTML=""),We(s.type=="template"?t.content:t,ae(_)?_:[_],s,n,l,S=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,o,r?r[0]:n.__k&&z(n,0),c,h),r!=null)for(d=r.length;d--;)me(r[d]);c||(d="value",S=="progress"&&m==null?t.removeAttribute("value"):m!=null&&(m!==t[d]||S=="progress"&&!m||S=="option"&&m!=v[d])&&Z(t,d,m,v[d],i),d="checked",C!=null&&C!=t[d]&&Z(t,d,C,v[d],i))}return t}function xe(t,s,n){try{if(typeof t=="function"){var l=typeof t.__u=="function";l&&t.__u(),l&&s==null||(t.__u=t(s))}else t.current=s}catch(i){k.__e(i,n)}}function Ye(t,s,n){var l,i;if(k.unmount&&k.unmount(t),(l=t.ref)&&(l.current&&l.current!=t.__e||xe(l,null,s)),(l=t.__c)!=null){if(l.componentWillUnmount)try{l.componentWillUnmount()}catch(r){k.__e(r,s)}l.base=l.__P=null}if(l=t.__k)for(i=0;i<l.length;i++)l[i]&&Ye(l[i],s,n||typeof t.type!="function");n||me(t.__e),t.__c=t.__=t.__e=void 0}function ht(t,s,n){return this.constructor(t,n)}function ut(t,s,n){var l,i,r,o;s==document&&(s=document.documentElement),k.__&&k.__(t,s),i=(l=!1)?null:s.__k,r=[],o=[],fe(s,t=s.__k=at(j,null,[t]),i||Q,Q,s.namespaceURI,i?null:s.firstChild?ie.call(s.childNodes):null,r,i?i.__e:s.firstChild,l,o),Be(r,t,o)}ie=He.slice,k={__e:function(t,s,n,l){for(var i,r,o;s=s.__;)if((i=s.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(t)),o=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,l||{}),o=i.__d),o)return i.__E=i}catch(c){t=c}throw t}},De=0,te.prototype.setState=function(t,s){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=R({},this.state),typeof t=="function"&&(t=t(R({},n),this.props)),t&&R(n,t),t!=null&&this.__v&&(s&&this._sb.push(s),be(this))},te.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),be(this))},te.prototype.render=j,W=[],je=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ne=function(t,s){return t.__v.__b-s.__v.__b},re.__r=0,Re=/(PointerCapture)$|Capture$/i,_e=0,ce=ye(!1),de=ye(!0);var pt=0;function e(t,s,n,l,i,r){s||(s={});var o,c,h=s;if("ref"in h)for(c in h={},s)c=="ref"?o=s[c]:h[c]=s[c];var d={type:t,props:h,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--pt,__i:-1,__u:0,__source:i,__self:r};if(typeof t=="function"&&(o=t.defaultProps))for(c in o)h[c]===void 0&&(h[c]=o[c]);return k.vnode&&k.vnode(d),d}var le,P,oe,we,ue=0,Ve=[],E=k,Se=E.__b,Ce=E.__r,ke=E.diffed,Te=E.__c,Pe=E.unmount,Le=E.__;function Qe(t,s){E.__h&&E.__h(P,t,ue||s),ue=0;var n=P.__H||(P.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function x(t){return ue=1,_t(Ke,t)}function _t(t,s,n){var l=Qe(le++,2);if(l.t=t,!l.__c&&(l.__=[Ke(void 0,s),function(c){var h=l.__N?l.__N[0]:l.__[0],d=l.t(h,c);h!==d&&(l.__N=[d,l.__[1]],l.__c.setState({}))}],l.__c=P,!P.__f)){var i=function(c,h,d){if(!l.__c.__H)return!0;var p=l.__c.__H.__.filter(function(_){return!!_.__c});if(p.every(function(_){return!_.__N}))return!r||r.call(this,c,h,d);var a=l.__c.props!==c;return p.forEach(function(_){if(_.__N){var u=_.__[0];_.__=_.__N,_.__N=void 0,u!==_.__[0]&&(a=!0)}}),r&&r.call(this,c,h,d)||a};P.__f=!0;var r=P.shouldComponentUpdate,o=P.componentWillUpdate;P.componentWillUpdate=function(c,h,d){if(this.__e){var p=r;r=void 0,i(c,h,d),r=p}o&&o.call(this,c,h,d)},P.shouldComponentUpdate=i}return l.__N||l.__}function B(t,s){var n=Qe(le++,3);!E.__s&&xt(n.__H,s)&&(n.__=t,n.u=s,P.__H.__h.push(n))}function mt(){for(var t;t=Ve.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(se),t.__H.__h.forEach(pe),t.__H.__h=[]}catch(s){t.__H.__h=[],E.__e(s,t.__v)}}E.__b=function(t){P=null,Se&&Se(t)},E.__=function(t,s){t&&s.__k&&s.__k.__m&&(t.__m=s.__k.__m),Le&&Le(t,s)},E.__r=function(t){Ce&&Ce(t),le=0;var s=(P=t.__c).__H;s&&(oe===P?(s.__h=[],P.__h=[],s.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(s.__h.forEach(se),s.__h.forEach(pe),s.__h=[],le=0)),oe=P},E.diffed=function(t){ke&&ke(t);var s=t.__c;s&&s.__H&&(s.__H.__h.length&&(Ve.push(s)!==1&&we===E.requestAnimationFrame||((we=E.requestAnimationFrame)||ft)(mt)),s.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),oe=P=null},E.__c=function(t,s){s.some(function(n){try{n.__h.forEach(se),n.__h=n.__h.filter(function(l){return!l.__||pe(l)})}catch(l){s.some(function(i){i.__h&&(i.__h=[])}),s=[],E.__e(l,n.__v)}}),Te&&Te(t,s)},E.unmount=function(t){Pe&&Pe(t);var s,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(l){try{se(l)}catch(i){s=i}}),n.__H=void 0,s&&E.__e(s,n.__v))};var Ee=typeof requestAnimationFrame=="function";function ft(t){var s,n=function(){clearTimeout(l),Ee&&cancelAnimationFrame(s),setTimeout(t)},l=setTimeout(n,35);Ee&&(s=requestAnimationFrame(n))}function se(t){var s=P,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),P=s}function pe(t){var s=P;t.__c=t.__(),P=s}function xt(t,s){return!t||t.length!==s.length||s.some(function(n,l){return n!==t[l]})}function Ke(t,s){return typeof s=="function"?s(t):s}const K={appName:"GoTinyMUSH",tagline:"Modern MUSH Server"},gt=[{page:"dashboard",label:"Dashboard",icon:"⌂"},{page:"import",label:"Import",icon:"⇧"},{page:"config",label:"Config",icon:"⚙"}];function bt({currentPage:t,onNavigate:s,setupMode:n,onLogout:l,children:i}){return e("div",{class:"flex min-h-screen",children:[e("aside",{class:"w-56 bg-slate-800 border-r border-slate-700 flex flex-col",children:[e("div",{class:"p-4 border-b border-slate-700",children:[e("h1",{class:"text-lg font-bold text-indigo-400",children:K.appName}),e("p",{class:"text-xs text-slate-400",children:K.tagline})]}),e("nav",{class:"flex-1 p-2",children:gt.map(r=>e("button",{onClick:()=>s(r.page),class:`w-full text-left px-3 py-2 rounded text-sm mb-1 flex items-center gap-2 transition-colors ${t===r.page?"bg-indigo-500/20 text-indigo-300":"text-slate-300 hover:bg-slate-700"}`,children:[e("span",{children:r.icon}),r.label]},r.page))}),n&&e("div",{class:"p-3 m-2 bg-amber-500/10 border border-amber-500/30 rounded text-xs text-amber-300",children:"Setup mode active"}),l&&e("div",{class:"p-2 border-t border-slate-700",children:e("button",{onClick:l,class:"w-full text-left px-3 py-2 rounded text-sm text-slate-400 hover:bg-slate-700 hover:text-slate-300 transition-colors",children:"Logout"})})]}),e("main",{class:"flex-1 p-6 overflow-auto",children:i})]})}const Je="/admin/api";let ne=null;function vt(t){ne=t}async function T(t,s,n){const l={method:t,headers:{"Content-Type":"application/json"}};n!==void 0&&(l.body=JSON.stringify(n));const i=await fetch(`${Je}${s}`,l);if(!i.ok){i.status===401&&!s.startsWith("/auth/")&&(ne==null||ne());const r=await i.json().catch(()=>({error:i.statusText}));throw new Error(r.error||i.statusText)}return i.json()}const w={serverStatus:()=>T("GET","/server/status"),serverStart:()=>T("POST","/server/start"),serverStop:()=>T("POST","/server/stop"),getConfig:()=>T("GET","/config"),putConfig:t=>T("PUT","/config",t),importUpload:t=>T("POST","/import/upload",{path:t}),importUploadFile:async t=>{const s=new FormData;s.append("flatfile",t);const n=await fetch(`${Je}/import/upload`,{method:"POST",body:s});if(!n.ok){const l=await n.json().catch(()=>({error:n.statusText}));throw new Error(l.error||n.statusText)}return n.json()},importValidate:()=>T("POST","/import/validate"),importFindings:()=>T("GET","/import/findings"),importFix:(t,s)=>T("POST","/import/fix",{finding_id:t,category:s}),importCommit:()=>T("POST","/import/commit"),importCommitProgress:()=>T("GET","/import/commit/progress"),importSession:()=>T("GET","/import/session"),importReset:()=>T("DELETE","/import/session"),importDiscover:()=>T("POST","/import/discover"),importAssign:(t,s)=>T("POST","/import/assign",{path:t,role:s}),importConvertConfig:t=>T("POST","/import/convert-config",{path:t}),importParseComsys:t=>T("POST","/import/parse-comsys",{path:t}),importGetFile:(t,s)=>T("GET",`/import/file/${encodeURIComponent(t)}/${encodeURIComponent(s)}`),importPutFile:(t,s,n)=>T("PUT",`/import/file/${encodeURIComponent(t)}/${encodeURIComponent(s)}`,{content:n}),setupStatus:()=>T("GET","/setup/status"),createNewDB:()=>T("POST","/import/create-new"),serverLaunch:()=>T("POST","/server/launch"),authLogin:t=>T("POST","/auth/login",{password:t}),authLogout:()=>T("POST","/auth/logout"),authStatus:()=>T("GET","/auth/status"),authChangePassword:(t,s)=>T("POST","/auth/change-password",{current:t,new:s})};function $e(){const[t,s]=x(null),[n,l]=x(""),[i,r]=x(!0),[o,c]=x(""),h=()=>{r(!0),w.serverStatus().then(v=>{s(v),l("")}).catch(v=>l(v.message)).finally(()=>r(!1))};B(()=>{h();const v=setInterval(h,5e3);return()=>clearInterval(v)},[]);const d=async()=>{c("");try{await w.serverStart(),h()}catch(v){c(v.message)}},p=async()=>{c("");try{await w.serverStop(),h()}catch(v){c(v.message)}};if(i&&!t)return e("div",{class:"text-slate-400",children:"Loading..."});if(n)return e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-4 text-red-300",children:n});const a=t==null?void 0:t.setup_mode,_=window.location.hostname,u=t==null?void 0:t.connections,m=t==null?void 0:t.queue,C=t==null?void 0:t.memory;return e("div",{children:[e("h2",{class:"text-2xl font-bold mb-6",children:"Dashboard"}),e("div",{class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e(X,{label:"Server Status",value:a?"Setup Mode":t!=null&&t.running?"Running":"Stopped",color:a?"text-amber-400":t!=null&&t.running?"text-green-400":"text-red-400"}),e(X,{label:"Connected Players",value:String((t==null?void 0:t.player_count)??0),color:"text-cyan-400"}),e(X,{label:"Objects",value:String((t==null?void 0:t.object_count)??0),color:"text-indigo-400"}),e(X,{label:"Uptime",value:(t==null?void 0:t.uptime)>0?yt(t.uptime):"-",color:"text-slate-300"})]}),(t==null?void 0:t.running)&&!a&&e("div",{class:"bg-slate-800 rounded p-3 mb-4 flex flex-wrap gap-x-6 gap-y-1 text-sm",children:[t.game_name&&e("span",{children:[e("span",{class:"text-slate-500",children:"Name:"})," ",e("span",{class:"text-slate-200",children:t.game_name})]}),t.version&&e("span",{children:[e("span",{class:"text-slate-500",children:"Version:"})," ",e("span",{class:"text-slate-200",children:t.version})]}),t.port>0&&e("span",{children:[e("span",{class:"text-slate-500",children:"Port:"})," ",e("span",{class:"text-slate-200",children:t.port})]}),t.channels!=null&&e("span",{children:[e("span",{class:"text-slate-500",children:"Channels:"})," ",e("span",{class:"text-slate-200",children:t.channels})]}),t.mail_enabled!=null&&e("span",{children:[e("span",{class:"text-slate-500",children:"Mail:"})," ",e("span",{class:"text-slate-200",children:t.mail_enabled?"Enabled":"Disabled"})]})]}),(t==null?void 0:t.running)&&!a&&(u||m||C)&&e("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[u&&e("div",{class:"bg-slate-800 rounded p-4",children:[e("h3",{class:"text-xs text-slate-400 uppercase tracking-wider mb-2",children:"Connections"}),e("div",{class:"space-y-1 text-sm",children:[e(D,{label:"Total",value:u.total}),e(D,{label:"TCP",value:u.tcp}),e(D,{label:"WebSocket",value:u.websocket}),e(D,{label:"Login Screen",value:u.login_screen}),e(D,{label:"Authenticated",value:u.connected})]})]}),m&&e("div",{class:"bg-slate-800 rounded p-4",children:[e("h3",{class:"text-xs text-slate-400 uppercase tracking-wider mb-2",children:"Command Queue"}),e("div",{class:"space-y-1 text-sm",children:[e(D,{label:"Immediate",value:m.immediate}),e(D,{label:"Waiting",value:m.waiting}),e(D,{label:"Semaphore",value:m.semaphore})]})]}),C&&e("div",{class:"bg-slate-800 rounded p-4",children:[e("h3",{class:"text-xs text-slate-400 uppercase tracking-wider mb-2",children:"Memory"}),e("div",{class:"space-y-1 text-sm",children:[e(D,{label:"Heap",value:`${(C.heap_alloc_mb??0).toFixed(1)} MB`}),e(D,{label:"Goroutines",value:C.goroutines})]})]})]}),o&&e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-3 mb-4 text-red-300 text-sm",children:[o,e("button",{onClick:()=>c(""),class:"ml-2 text-red-400 hover:text-red-300",children:"×"})]}),a&&e("div",{class:"bg-amber-500/10 border border-amber-500/30 rounded p-4 mb-4 text-amber-300 text-sm",children:"The server is in setup mode. Use the Setup wizard or Import page to create or import a game database, then launch the server."}),(t==null?void 0:t.running)&&!a&&e("div",{class:"bg-slate-800 rounded p-4 mb-4",children:[e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-3",children:"How to Connect"}),e("div",{class:"space-y-2 text-sm",children:[e("div",{class:"flex items-start gap-3",children:[e("span",{class:"text-slate-500 w-24 shrink-0",children:"Telnet:"}),e("code",{class:"text-cyan-300 bg-slate-900 px-2 py-0.5 rounded",children:["telnet ",_," ",(t==null?void 0:t.port)||6886]})]}),e("div",{class:"flex items-start gap-3",children:[e("span",{class:"text-slate-500 w-24 shrink-0",children:"MU* Client:"}),e("span",{class:"text-slate-300",children:["Host: ",e("code",{class:"text-cyan-300 bg-slate-900 px-1 rounded",children:_})," Port: ",e("code",{class:"text-cyan-300 bg-slate-900 px-1 rounded",children:(t==null?void 0:t.port)||6886})]})]}),e("div",{class:"flex items-start gap-3",children:[e("span",{class:"text-slate-500 w-24 shrink-0",children:"Web Client:"}),e("a",{href:`http://${_}:8443/`,target:"_blank",class:"text-indigo-400 hover:text-indigo-300",children:["http://",_,":8443/"]})]}),e("div",{class:"mt-3 pt-3 border-t border-slate-700",children:[e("div",{class:"flex items-start gap-3",children:[e("span",{class:"text-slate-500 w-24 shrink-0",children:"God Login:"}),e("span",{class:"text-slate-300",children:e("code",{class:"text-cyan-300 bg-slate-900 px-1 rounded",children:"connect Wizard <password>"})})]}),e("p",{class:"text-slate-500 text-xs mt-1 ml-27",children:"Password is set via MUSH_GODPASS env variable. Change it in-game with: @password <old>=<new>"})]})]})]}),e("div",{class:"flex gap-3",children:[t!=null&&t.running?e("button",{onClick:p,class:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded text-sm transition-colors",children:"Stop Server"}):e("button",{onClick:d,disabled:a,class:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Start Server"}),e("button",{onClick:h,class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-sm transition-colors",children:"Refresh"})]})]})}function X({label:t,value:s,color:n}){return e("div",{class:"bg-slate-800 rounded p-4",children:[e("div",{class:"text-xs text-slate-400 uppercase tracking-wider mb-1",children:t}),e("div",{class:`text-2xl font-bold ${n}`,children:s})]})}function D({label:t,value:s}){return e("div",{class:"flex justify-between",children:[e("span",{class:"text-slate-400",children:t}),e("span",{class:"text-slate-200",children:s})]})}function yt(t){const s=Math.floor(t/86400),n=Math.floor(t%86400/3600),l=Math.floor(t%3600/60),i=Math.floor(t%60);return s>0?`${s}d ${n}h ${l}m`:n>0?`${n}h ${l}m ${i}s`:l>0?`${l}m ${i}s`:`${i}s`}const Fe={0:"text-red-300 bg-red-950/50 border-red-500/30",1:"text-amber-200 bg-amber-950/40 border-amber-500/30",2:"text-blue-300 bg-blue-950/50 border-blue-500/30"},wt={0:"ERROR",1:"WARNING",2:"INFO"};function Me({text:t,highlights:s,hlClass:n}){if(!s||s.length===0)return e(j,{children:t});const l=[];let i=0;for(const r of s)r.start>i&&l.push(e("span",{children:t.slice(i,r.start)},`t${i}`)),l.push(e("span",{class:n,children:t.slice(r.start,r.end)},`h${r.start}`)),i=r.end;return i<t.length&&l.push(e("span",{children:t.slice(i)},`t${i}`)),e(j,{children:l})}function St({finding:t,onFix:s}){const n=Fe[t.severity]||Fe[2];return e("div",{class:`border rounded p-3 mb-2 ${n}`,children:[e("div",{class:"flex items-start justify-between gap-2",children:[e("div",{class:"flex-1 min-w-0",children:[e("div",{class:"flex items-center gap-2 mb-1",children:[e("span",{class:"text-xs font-mono opacity-70",children:wt[t.severity]}),e("span",{class:"text-xs font-mono opacity-50",children:["#",t.object_ref]}),t.attr_name&&e("span",{class:"text-xs font-mono opacity-50",children:t.attr_name})]}),e("p",{class:"text-sm text-slate-200",children:t.description})]}),t.fixable&&!t.fixed&&s&&e("button",{onClick:()=>s(t.id),class:"px-2 py-1 bg-green-600 hover:bg-green-500 text-white text-xs rounded shrink-0 transition-colors",children:"Fix"}),t.fixed&&e("span",{class:"text-xs text-green-400 shrink-0",children:"Fixed"})]}),t.explanation&&e("div",{class:"mt-2 text-xs text-slate-400 bg-slate-800/40 rounded p-2 border-l-2 border-slate-600",children:t.explanation}),t.current&&e("div",{class:"mt-2",children:[e("div",{class:"text-xs text-slate-400 mb-0.5",children:"Current:"}),e("pre",{class:"text-xs font-mono bg-slate-900/60 text-slate-300 rounded p-1.5 overflow-x-auto whitespace-pre-wrap break-all",children:e(Me,{text:t.current,highlights:t.current_hl,hlClass:"bg-red-500/30 text-red-200 rounded px-0.5"})})]}),t.proposed&&e("div",{class:"mt-1",children:[e("div",{class:"text-xs text-slate-400 mb-0.5",children:"Proposed:"}),e("pre",{class:"text-xs font-mono bg-slate-900/60 text-slate-300 rounded p-1.5 overflow-x-auto whitespace-pre-wrap break-all",children:e(Me,{text:t.proposed,highlights:t.proposed_hl,hlClass:"bg-green-500/30 text-green-200 rounded px-0.5"})})]}),t.effect&&e("div",{class:"mt-1 text-xs text-slate-400",children:[e("span",{class:"text-slate-500",children:"Changes:"})," ",t.effect]})]})}const Ct={0:"Double-Escaped Brackets",1:"Attribute Flag Anomalies",2:"Escape Sequences",3:"Backslash-Percent Patterns",4:"Integrity Errors",5:"Integrity Warnings"},Ae={0:"C TinyMUSH processes queued commands with an extra evaluation pass. Code written for C used double-escaping (\\\\[text\\\\]) to compensate. GoTinyMUSH evaluates correctly, so these need to be simplified to single-escaping ([text]) to display properly.",1:"Some $-command attributes have patterns that could be confused with internal metadata formatting. GoTinyMUSH handles these correctly — these are informational only.",2:"Attributes containing raw ANSI escape codes (ESC bytes) for terminal colors and formatting. GoTinyMUSH supports these natively — no action needed.",3:"Similar to bracket escaping, backslash-percent patterns (\\\\%) were doubled for C's extra evaluation pass. The fix removes the extra backslash so percent-substitutions (%r, %t, %0-%9, etc.) work correctly.",4:"Objects referencing other objects (locations, parents, zones, links) that don't exist in the database. These may indicate objects that were destroyed without cleaning up references.",5:"Suspicious but non-critical reference issues, such as objects owned by non-player objects."},kt={0:"double-escape",1:"attr-flags",2:"escape-seq",3:"percent",4:"integrity-error",5:"integrity-warning"};function Tt({findings:t,onFix:s,onFixAll:n}){const l=new Map;for(const r of t){const o=l.get(r.category)||[];o.push(r),l.set(r.category,o)}const i=Array.from(l.keys()).sort();return e("div",{children:i.map(r=>{const o=l.get(r),c=o.filter(d=>d.fixable&&!d.fixed),h=o.filter(d=>d.fixed);return e("div",{class:"mb-6",children:[e("div",{class:"flex items-center justify-between mb-2",children:[e("h3",{class:"text-lg font-semibold text-slate-200",children:[Ct[r]||`Category ${r}`,e("span",{class:"text-sm font-normal text-slate-400 ml-2",children:["(",o.length," total",h.length>0?`, ${h.length} fixed`:"",")"]})]}),c.length>0&&n&&e("button",{onClick:()=>n(kt[r]),class:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-xs rounded transition-colors",children:["Fix All (",c.length,")"]})]}),Ae[r]&&e("div",{class:"text-xs text-slate-400 bg-slate-800/30 rounded p-2 mb-3 border-l-2 border-indigo-500/40",children:Ae[r]}),o.map(d=>e(St,{finding:d,onFix:s},d.id))]},r)})})}function Pt({tabs:t,children:s}){var i;const[n,l]=x(((i=t[0])==null?void 0:i.id)||"");return e("div",{children:[e("div",{class:"flex border-b border-slate-700 mb-4",children:t.map(r=>e("button",{onClick:()=>l(r.id),class:`px-4 py-2 text-sm transition-colors border-b-2 -mb-px ${n===r.id?"border-indigo-500 text-indigo-400":"border-transparent text-slate-400 hover:text-slate-300"}`,children:[r.label,r.badge!==void 0&&e("span",{class:"ml-1.5 px-1.5 py-0.5 text-xs bg-slate-700 rounded-full",children:r.badge})]},r.id))}),s(n)]})}function Lt({name:t,role:s,mode:n,initialContent:l,onSave:i}){const[r,o]=x(l||""),[c,h]=x(!1),[d,p]=x(!1),[a,_]=x(""),[u,m]=x(!l);B(()=>{!l&&n==="staged"&&(m(!0),w.importGetFile(s,t).then(b=>o(b.content||"")).catch(b=>_(b.message)).finally(()=>m(!1)))},[t,s]);const C=r.split(`
`).length,v=async()=>{h(!0),p(!1),_("");try{i?i(r):await w.importPutFile(s,t,r),p(!0),setTimeout(()=>p(!1),3e3)}catch(b){_(b.message)}finally{h(!1)}};return u?e("div",{class:"text-slate-400 text-sm",children:["Loading ",t,"..."]}):e("div",{class:"bg-slate-800 rounded p-4",children:[e("div",{class:"flex items-center justify-between mb-2",children:[e("div",{children:[e("span",{class:"text-sm font-mono text-slate-300",children:t}),e("span",{class:"ml-2 text-xs text-slate-500",children:[C," lines"]})]}),e("div",{class:"flex items-center gap-2",children:[d&&e("span",{class:"text-green-400 text-xs",children:"Saved!"}),a&&e("span",{class:"text-red-400 text-xs",children:a}),e("button",{onClick:v,disabled:c,class:"px-3 py-1 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-xs transition-colors disabled:opacity-50",children:c?"Saving...":"Save"})]})]}),e("textarea",{value:r,onInput:b=>o(b.target.value),class:"w-full h-64 px-3 py-2 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 font-mono resize-y focus:outline-none focus:border-indigo-500",spellcheck:!1})]})}function Et({name:t,initialContent:s,onSave:n}){const[l,i]=x(s||""),[r,o]=x(!1),[c,h]=x(!1),[d,p]=x(""),[a,_]=x(!s);B(()=>{s||(_(!0),w.importGetFile("alias_config",t).then(m=>i(m.content||"")).catch(m=>p(m.message)).finally(()=>_(!1)))},[t]);const u=async()=>{o(!0),h(!1),p("");try{n?n(l):await w.importPutFile("alias_config",t,l),h(!0),setTimeout(()=>h(!1),3e3)}catch(m){p(m.message)}finally{o(!1)}};return a?e("div",{class:"text-slate-400 text-sm",children:["Loading ",t,"..."]}):e("div",{class:"bg-slate-800 rounded p-4",children:[e("div",{class:"flex items-center justify-between mb-2",children:[e("div",{children:[e("span",{class:"text-sm font-mono text-slate-300",children:t}),e("span",{class:"ml-2 text-xs text-slate-500",children:"YAML alias config"})]}),e("div",{class:"flex items-center gap-2",children:[c&&e("span",{class:"text-green-400 text-xs",children:"Saved!"}),d&&e("span",{class:"text-red-400 text-xs",children:d}),e("button",{onClick:u,disabled:r,class:"px-3 py-1 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-xs transition-colors disabled:opacity-50",children:r?"Saving...":"Save"})]})]}),e("textarea",{value:l,onInput:m=>i(m.target.value),class:"w-full h-80 px-3 py-2 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 font-mono resize-y focus:outline-none focus:border-indigo-500",spellcheck:!1,placeholder:"# YAML alias configuration"})]})}function Ze({mode:t="live",stagedContent:s,onStagedSave:n}){const[l,i]=x(null),[r,o]=x(""),[c,h]=x(""),[d,p]=x(!1),[a,_]=x(!1),[u,m]=x(!1),[C,v]=x("");B(()=>{if(t==="staged"&&s){v(s);try{const y={};for(const $ of s.split(`
`)){const L=$.match(/^(\w+):\s*(.*)$/);if(L){const[,U,F]=L;F==="true"?y[U]=!0:F==="false"?y[U]=!1:/^\d+$/.test(F)?y[U]=parseInt(F):F.startsWith('"')&&F.endsWith('"')?y[U]=F.slice(1,-1):y[U]=F}}Object.keys(y).length>0&&i(y)}catch{m(!0)}return}t==="live"&&w.getConfig().then(y=>{i(y.config),o(y.path)}).catch(y=>h(y.message))},[t,s]);const b=async()=>{p(!0),_(!1),h("");try{t==="staged"?n&&n(C):l&&await w.putConfig(l),_(!0),setTimeout(()=>_(!1),3e3)}catch(y){h(y.message)}finally{p(!1)}},S=(y,$)=>{i(L=>L?{...L,[y]:$}:null)};if(c&&!l&&!C)return e("div",{children:[e("h2",{class:"text-2xl font-bold mb-6",children:"Configuration"}),e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-4 text-red-300",children:c})]});if(!l&&!C)return e("div",{class:"text-slate-400",children:"Loading configuration..."});if(u||t==="staged")return e("div",{children:[e("div",{class:"flex items-center justify-between mb-4",children:[e("div",{children:[e("h2",{class:"text-2xl font-bold",children:t==="staged"?"Config Preview":"Configuration"}),r&&e("p",{class:"text-xs text-slate-400 font-mono",children:r})]}),e("div",{class:"flex items-center gap-3",children:[l&&e("button",{onClick:()=>m(!u),class:"px-3 py-1 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded text-xs transition-colors",children:u?"Structured View":"Raw YAML"}),a&&e("span",{class:"text-green-400 text-sm",children:"Saved!"}),c&&e("span",{class:"text-red-400 text-sm",children:c}),e("button",{onClick:b,disabled:d,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:d?"Saving...":"Save"})]})]}),u||!l?e("textarea",{value:C,onInput:y=>v(y.target.value),class:"w-full h-96 px-3 py-2 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 font-mono resize-y focus:outline-none focus:border-indigo-500",spellcheck:!1}):$t(l,S)]});const M=et(l);return e("div",{children:[e("div",{class:"flex items-center justify-between mb-6",children:[e("div",{children:[e("h2",{class:"text-2xl font-bold",children:"Configuration"}),e("p",{class:"text-xs text-slate-400 font-mono",children:r})]}),e("div",{class:"flex items-center gap-3",children:[e("button",{onClick:()=>{const y=Object.entries(l).map(([$,L])=>`${$}: ${JSON.stringify(L)}`).join(`
`);v(y),m(!0)},class:"px-3 py-1 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded text-xs transition-colors",children:"Raw YAML"}),a&&e("span",{class:"text-green-400 text-sm",children:"Saved!"}),c&&e("span",{class:"text-red-400 text-sm",children:c}),e("button",{onClick:b,disabled:d,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:d?"Saving...":"Save"})]})]}),M.map(([y,$])=>e("div",{class:"mb-6",children:[e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-2",children:y}),e("div",{class:"bg-slate-800 rounded p-4 space-y-3",children:$.map(L=>e(Xe,{name:L,value:l[L],onChange:U=>S(L,U)},L))})]},y))]})}function $t(t,s){const n=et(t);return e(j,{children:n.map(([l,i])=>e("div",{class:"mb-6",children:[e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-2",children:l}),e("div",{class:"bg-slate-800 rounded p-4 space-y-3",children:i.map(r=>e(Xe,{name:r,value:t[r],onChange:o=>s(r,o)},r))})]},l))})}function Xe({name:t,value:s,onChange:n}){const l=typeof s;return l==="boolean"?e("label",{class:"flex items-center gap-3 cursor-pointer",children:[e("input",{type:"checkbox",checked:s,onChange:i=>n(i.target.checked),class:"w-4 h-4 rounded border-slate-600 text-indigo-600 focus:ring-indigo-500"}),e("span",{class:"text-sm text-slate-300",children:t})]}):l==="number"?e("div",{class:"flex items-center gap-3",children:[e("label",{class:"text-sm text-slate-400 w-48 shrink-0",children:t}),e("input",{type:"number",value:s,onInput:i=>n(Number(i.target.value)),class:"flex-1 px-2 py-1 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 focus:outline-none focus:border-indigo-500"})]}):Array.isArray(s)?e("div",{class:"flex items-start gap-3",children:[e("label",{class:"text-sm text-slate-400 w-48 shrink-0 pt-1",children:t}),e("input",{type:"text",value:s.join(", "),onInput:i=>n(i.target.value.split(",").map(r=>r.trim()).filter(Boolean)),class:"flex-1 px-2 py-1 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 focus:outline-none focus:border-indigo-500",placeholder:"comma-separated values"})]}):e("div",{class:"flex items-center gap-3",children:[e("label",{class:"text-sm text-slate-400 w-48 shrink-0",children:t}),e("input",{type:"text",value:s??"",onInput:i=>n(i.target.value),class:"flex-1 px-2 py-1 bg-slate-900 border border-slate-600 rounded text-sm text-slate-200 focus:outline-none focus:border-indigo-500"})]})}function et(t){const s={},n={mud_name:"Identity",port:"Identity",master_room:"Rooms",player_starting_room:"Rooms",player_starting_home:"Rooms",default_home:"Rooms",money_name_singular:"Economy",money_name_plural:"Economy",starting_money:"Economy",paycheck:"Economy",earn_limit:"Economy",page_cost:"Economy",wait_cost:"Economy",link_cost:"Economy",idle_timeout:"Idle",idle_wiz_dark:"Idle",queue_idle_chunk:"Queue",function_invocation_limit:"Queue",machine_command_cost:"Queue",output_limit:"Output",web_enabled:"Web",web_port:"Web",web_host:"Web",web_domain:"Web",web_static_dir:"Web",web_cors_origins:"Web",web_rate_limit:"Web",jwt_secret:"Web",jwt_expiry:"Web",guest_char_num:"Guests",guest_prefixes:"Guests",guest_suffixes:"Guests",guest_basename:"Guests",number_guests:"Guests",guest_password:"Guests",guest_start_room:"Guests",mail_enabled:"Modules",comsys_enabled:"Modules",mail_expiration:"Modules",spellcheck_enabled:"Modules",spellcheck_url:"Modules",pueblo_enabled:"Modules",pueblo_version:"Modules",sql_enabled:"SQL",sql_database:"SQL",sql_query_limit:"SQL",sql_timeout:"SQL",archive_dir:"Backup",archive_interval:"Backup",archive_retain:"Backup",archive_hook:"Backup"};for(const l of Object.keys(t)){const i=n[l]||"Other";s[i]||(s[i]=[]),s[i].push(l)}return Object.entries(s)}const Ue=["upload","discover","configure","summary","resolve","review","committed"],Ie={flatfile:"Flatfile",comsys:"Comsys DB",main_config:"Main Config",alias_config:"Alias Config",text:"Text File",dict:"Dictionary",discarded:"Discarded",unknown:"Unknown"},Ft=["flatfile","comsys","main_config","alias_config","text","dict","discarded","unknown"],Mt={high:"text-green-400",medium:"text-yellow-400",low:"text-red-400",manual:"text-blue-400"};function At(){const[t,s]=x("upload"),[n,l]=x(""),[i,r]=x(!1),[o,c]=x(null),[h,d]=x([]),[p,a]=x(null),[_,u]=x([]),[m,C]=x(""),[v,b]=x(null),[S,M]=x([]),[y,$]=x([]),L=async f=>{var N;const O=(N=f.target.files)==null?void 0:N[0];if(O){r(!0),l("");try{const A=await w.importUploadFile(O);if(c(A),A.source==="foreign_archive"||A.source==="gotinymush_archive"){s("discover");const V=await w.importDiscover();u(V.files||[])}else s("summary")}catch(A){l(A.message)}finally{r(!1)}}},U=async f=>{r(!0),l("");try{const g=await w.importUpload(f);if(c(g),g.source==="foreign_archive"||g.source==="gotinymush_archive"){s("discover");const O=await w.importDiscover();u(O.files||[])}else s("summary")}catch(g){l(g.message)}finally{r(!1)}},F=async(f,g)=>{try{await w.importAssign(f,g),u(O=>O.map(N=>N.path===f?{...N,role:g,confidence:"manual",reason:"manually assigned"}:N))}catch(O){l(O.message)}},G=async()=>{var f;r(!0),l("");try{const g=_.find(A=>A.role==="main_config");if(g)if(((f=g.path.split(".").pop())==null?void 0:f.toLowerCase())==="conf"){const V=await w.importConvertConfig(g.path);C(V.content||"")}else{const V=await w.importGetFile("main_config",g.path.split("/").pop()||"");C(V.content||"")}const O=_.find(A=>A.role==="comsys");if(O){const A=await w.importParseComsys(O.path);b({channels:A.channels||[],alias_count:A.alias_count||0})}const N=await w.importSession();M(N.text_files||[]),$(N.alias_files||[]),s("configure")}catch(g){l(g.message)}finally{r(!1)}},q=()=>{o!=null&&o.object_count||_.some(f=>f.role==="flatfile"),s("summary")},I=async()=>{var f;r(!0),l("");try{const g=await w.importValidate();d(((f=g.report)==null?void 0:f.findings)||[]),a(g.report),s("resolve")}catch(g){l(g.message)}finally{r(!1)}},H=async f=>{try{await w.importFix(f);const g=await w.importFindings();d(g.findings||[]),a(g)}catch(g){l(g.message)}},tt=async f=>{try{await w.importFix(void 0,f);const g=await w.importFindings();d(g.findings||[]),a(g)}catch(g){l(g.message)}},[J,Y]=x(null),st=async()=>{r(!0),l(""),Y({stage:"starting",detail:"Starting commit...",percent:0});const f=setInterval(async()=>{try{const g=await w.importCommitProgress();g.stage&&g.stage!=="idle"&&Y(g),g.stage==="error"&&(clearInterval(f),l(g.error||"Commit failed"),Y(null),r(!1))}catch{}},500);try{await w.importCommit(),clearInterval(f),Y(null),s("committed")}catch(g){clearInterval(f),Y(null),l(g.message)}finally{r(!1)}},nt=async()=>{try{await w.importReset(),s("upload"),c(null),u([]),C(""),b(null),M([]),$([]),d([]),a(null)}catch(f){l(f.message)}},rt=async()=>{try{const f=await w.importFindings();d(f.findings||[]),a(f)}catch(f){l(f.message)}},lt=(o==null?void 0:o.source)==="flatfile"?Ue.filter(f=>f!=="discover"&&f!=="configure"):Ue;return e("div",{children:[e("div",{class:"flex items-center justify-between mb-6",children:[e("h2",{class:"text-2xl font-bold",children:"Import"}),t!=="upload"&&t!=="committed"&&e("button",{onClick:nt,class:"px-3 py-1 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded text-xs transition-colors",children:"Start Over"})]}),e("div",{class:"flex items-center gap-2 mb-6 text-sm flex-wrap",children:lt.map((f,g)=>e("div",{class:"flex items-center gap-2",children:[g>0&&e("span",{class:"text-slate-600",children:"→"}),e("span",{class:t===f?"text-indigo-400 font-semibold":"text-slate-500",children:f.charAt(0).toUpperCase()+f.slice(1)})]},f))}),n&&e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-3 mb-4 text-red-300 text-sm",children:[n,e("button",{onClick:()=>l(""),class:"ml-2 text-red-400 hover:text-red-300",children:"×"})]}),t==="upload"&&e(Ut,{loading:i,onFileUpload:L,onPathUpload:U}),t==="discover"&&e(It,{files:_,loading:i,onReassign:F,onConfirm:G}),t==="configure"&&e(Ot,{configContent:m,comsysData:v,textFileNames:S,aliasFileNames:y,onConfigSave:f=>{C(f),w.importPutFile("main_config","config",f).catch(()=>{})},onDone:q}),t==="summary"&&o&&e(Dt,{result:o,loading:i,onValidate:I,hasExtraFiles:S.length>0||y.length>0||!!m}),t==="resolve"&&e("div",{children:[(p==null?void 0:p.categories)&&e("div",{class:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:Object.entries(p.categories).map(([f,g])=>e("div",{class:"bg-slate-800 rounded p-3",children:[e("div",{class:"text-xs text-slate-400",children:g.label||f}),e("div",{class:"text-lg font-bold text-slate-200",children:g.total}),g.fixed>0&&e("div",{class:"text-xs text-green-400",children:[g.fixed," fixed"]})]},f))}),e(Tt,{findings:h,onFix:H,onFixAll:tt}),e("div",{class:"flex gap-3 mt-4",children:[e("button",{onClick:()=>s("review"),class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors",children:"Review & Commit"}),e("button",{onClick:rt,class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-sm transition-colors",children:"Refresh"})]})]}),t==="review"&&e("div",{children:[e("h3",{class:"text-lg font-semibold mb-3",children:"Review Changes"}),e("div",{class:"bg-slate-800 rounded p-4 mb-4",children:[e("p",{class:"text-sm text-slate-300",children:[h.filter(f=>f.fixed).length," fixes applied out of ",h.length," total findings."]}),e("p",{class:"text-sm text-slate-400 mt-1",children:[h.filter(f=>f.fixable&&!f.fixed).length," fixable findings remain unapplied."]}),(S.length>0||!!m)&&e("div",{class:"mt-3 pt-3 border-t border-slate-700",children:[e("p",{class:"text-sm text-slate-400",children:"Additional files staged for commit:"}),e("ul",{class:"text-sm text-slate-300 mt-1 list-disc ml-4",children:[m&&e("li",{children:"Game configuration (YAML)"}),S.length>0&&e("li",{children:[S.length," text file(s)"]}),y.length>0&&e("li",{children:[y.length," alias config(s)"]})]})]})]}),J&&e("div",{class:"bg-slate-800 rounded p-4 mb-4",children:[e("div",{class:"flex items-center gap-3 mb-2",children:[e("div",{class:"inline-block w-4 h-4 border-2 border-indigo-400 border-t-transparent rounded-full animate-spin"}),e("span",{class:"text-sm text-slate-200",children:J.detail})]}),e("div",{class:"w-full bg-slate-700 rounded-full h-2",children:e("div",{class:"bg-indigo-500 h-2 rounded-full transition-all duration-300",style:{width:`${J.percent}%`}})}),e("div",{class:"text-xs text-slate-500 mt-1",children:[J.percent,"%"]})]}),e("div",{class:"flex gap-3",children:[e("button",{onClick:st,disabled:i,class:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:i?"Committing...":"Commit to Database"}),e("button",{onClick:()=>s("resolve"),disabled:i,class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-sm transition-colors disabled:opacity-50",children:"Back to Resolve"})]})]}),t==="committed"&&e(jt,{})]})}function Ut({loading:t,onFileUpload:s,onPathUpload:n}){const[l,i]=x("");return e("div",{class:"max-w-lg",children:[e("div",{class:"bg-slate-800 border-2 border-dashed border-slate-600 rounded-lg p-8 text-center mb-4",children:[e("p",{class:"text-slate-400 mb-3",children:"Upload a flatfile, archive (.tar.gz, .zip), or browse"}),e("input",{type:"file",accept:".flat,.FLAT,.gz,.tar.gz,.tgz,.zip",onChange:s,disabled:t,class:"block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:bg-indigo-600 file:text-white hover:file:bg-indigo-500 file:cursor-pointer"})]}),e("div",{class:"text-slate-500 text-center text-sm mb-4",children:"or"}),e("div",{class:"flex gap-2",children:[e("input",{type:"text",placeholder:"Path to file or directory on server...",value:l,onInput:r=>i(r.target.value),class:"flex-1 px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-slate-200 focus:outline-none focus:border-indigo-500"}),e("button",{onClick:()=>l&&n(l),disabled:t||!l,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:t?"Loading...":"Load"})]})]})}function It({files:t,loading:s,onReassign:n,onConfirm:l}){const i=t.reduce((r,o)=>{const c=o.role;return r[c]=(r[c]||0)+1,r},{});return e("div",{children:[e("h3",{class:"text-lg font-semibold mb-3",children:"Discovered Files"}),e("p",{class:"text-sm text-slate-400 mb-4",children:["Found ",t.length," files. Review role assignments and adjust if needed."]}),e("div",{class:"flex flex-wrap gap-2 mb-4",children:Object.entries(i).map(([r,o])=>e("span",{class:"px-2 py-1 bg-slate-800 rounded text-xs text-slate-300",children:[Ie[r]||r,": ",o]},r))}),i.discarded>0&&e("div",{class:"bg-slate-800/50 border border-slate-700 rounded p-3 mb-4 text-sm text-slate-400",children:[i.discarded," file(s) marked as discarded (C TinyMUSH artifacts not needed by GoTinyMUSH). These will be skipped during import. Your original archive is unchanged."]}),e("div",{class:"bg-slate-800 rounded overflow-hidden mb-4",children:e("table",{class:"w-full text-sm",children:[e("thead",{children:e("tr",{class:"border-b border-slate-700",children:[e("th",{class:"text-left px-3 py-2 text-slate-400 font-medium",children:"File"}),e("th",{class:"text-left px-3 py-2 text-slate-400 font-medium w-40",children:"Role"}),e("th",{class:"text-center px-3 py-2 text-slate-400 font-medium w-16",children:"Conf."}),e("th",{class:"text-right px-3 py-2 text-slate-400 font-medium w-20",children:"Size"})]})}),e("tbody",{children:t.map(r=>e("tr",{class:`border-b border-slate-700/50 hover:bg-slate-750 ${r.role==="discarded"?"opacity-40":""}`,children:[e("td",{class:"px-3 py-2",children:[e("div",{class:`font-mono text-xs ${r.role==="discarded"?"text-slate-500 line-through":"text-slate-300"}`,children:r.path}),e("div",{class:"text-xs text-slate-500 mt-0.5",children:r.reason})]}),e("td",{class:"px-3 py-2",children:e("select",{value:r.role,onChange:o=>n(r.path,o.target.value),class:"w-full px-2 py-1 bg-slate-900 border border-slate-600 rounded text-xs text-slate-300 focus:outline-none focus:border-indigo-500",children:Ft.map(o=>e("option",{value:o,children:Ie[o]},o))})}),e("td",{class:"px-3 py-2 text-center",children:e("span",{class:`text-lg ${Mt[r.confidence]||"text-slate-500"}`,title:r.confidence,children:"●"})}),e("td",{class:"px-3 py-2 text-right text-slate-400 text-xs font-mono",children:Nt(r.size)})]},r.path))})]})}),e("button",{onClick:l,disabled:s,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:s?"Processing...":"Confirm & Continue"})]})}function Ot({configContent:t,comsysData:s,textFileNames:n,aliasFileNames:l,onConfigSave:i,onDone:r}){const o=[];return t&&o.push({id:"config",label:"Config"}),l.length>0&&o.push({id:"aliases",label:"Aliases",badge:l.length}),n.length>0&&o.push({id:"text",label:"Text Files",badge:n.length}),s&&o.push({id:"comsys",label:"Comsys"}),o.length===0?e("div",{children:[e("p",{class:"text-slate-400 mb-4",children:"No additional files to configure."}),e("button",{onClick:r,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors",children:"Continue to Summary"})]}):e("div",{children:[e("h3",{class:"text-lg font-semibold mb-3",children:"Configure Files"}),e("p",{class:"text-sm text-slate-400 mb-4",children:"Review and edit staged files before committing."}),e(Pt,{tabs:o,children:c=>e(j,{children:[c==="config"&&e(Ze,{mode:"staged",stagedContent:t,onStagedSave:i}),c==="aliases"&&e("div",{class:"space-y-4",children:l.map(h=>e(Et,{name:h},h))}),c==="text"&&e("div",{class:"space-y-4",children:n.map(h=>e(Lt,{name:h,role:"text",mode:"staged"},h))}),c==="comsys"&&s&&e("div",{class:"bg-slate-800 rounded p-4",children:[e("div",{class:"grid grid-cols-2 gap-4 mb-4",children:[e("div",{children:[e("span",{class:"text-xs text-slate-400",children:"Channels"}),e("div",{class:"text-lg font-bold text-slate-200",children:s.channels.length})]}),e("div",{children:[e("span",{class:"text-xs text-slate-400",children:"Player Aliases"}),e("div",{class:"text-lg font-bold text-slate-200",children:s.alias_count})]})]}),s.channels.length>0&&e("table",{class:"w-full text-sm",children:[e("thead",{children:e("tr",{class:"border-b border-slate-700",children:[e("th",{class:"text-left px-2 py-1 text-slate-400",children:"Channel"}),e("th",{class:"text-left px-2 py-1 text-slate-400",children:"Owner"}),e("th",{class:"text-left px-2 py-1 text-slate-400",children:"Description"}),e("th",{class:"text-right px-2 py-1 text-slate-400",children:"Messages"})]})}),e("tbody",{children:s.channels.map(h=>e("tr",{class:"border-b border-slate-700/50",children:[e("td",{class:"px-2 py-1 text-slate-300 font-mono",children:h.name}),e("td",{class:"px-2 py-1 text-slate-400",children:["#",h.owner]}),e("td",{class:"px-2 py-1 text-slate-400 truncate max-w-xs",children:h.description}),e("td",{class:"px-2 py-1 text-slate-400 text-right",children:h.num_sent})]},h.name))})]})]})]})}),e("div",{class:"mt-4",children:e("button",{onClick:r,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors",children:"Continue to Summary"})})]})}function Dt({result:t,loading:s,onValidate:n,hasExtraFiles:l}){return e("div",{children:[e("h3",{class:"text-lg font-semibold mb-3",children:"Import Summary"}),e("div",{class:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[e("div",{class:"bg-slate-800 rounded p-3",children:[e("div",{class:"text-xs text-slate-400",children:"Objects"}),e("div",{class:"text-xl font-bold text-slate-200",children:t.object_count??0})]}),e("div",{class:"bg-slate-800 rounded p-3",children:[e("div",{class:"text-xs text-slate-400",children:"Attr Definitions"}),e("div",{class:"text-xl font-bold text-slate-200",children:t.attr_defs??0})]}),e("div",{class:"bg-slate-800 rounded p-3",children:[e("div",{class:"text-xs text-slate-400",children:"Total Attributes"}),e("div",{class:"text-xl font-bold text-slate-200",children:t.total_attrs??0})]}),e("div",{class:"bg-slate-800 rounded p-3",children:[e("div",{class:"text-xs text-slate-400",children:"Source"}),e("div",{class:"text-sm font-mono text-slate-200 truncate",children:t.source||t.file})]})]}),t.type_counts&&e("div",{class:"bg-slate-800 rounded p-4 mb-4",children:[e("h4",{class:"text-sm text-slate-400 mb-2",children:"Object Types"}),e("div",{class:"grid grid-cols-3 md:grid-cols-6 gap-2",children:Object.entries(t.type_counts).map(([i,r])=>e("div",{children:[e("span",{class:"text-xs text-slate-500",children:[i,": "]}),e("span",{class:"text-sm text-slate-200",children:r})]},i))})]}),l&&e("div",{class:"bg-slate-800/50 rounded p-3 mb-4 text-sm text-slate-400",children:"Additional files (config, text, aliases) are staged and will be committed with the database."}),e("button",{onClick:n,disabled:s,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:s?"Validating...":"Run Validation"})]})}function jt(){const[t,s]=x(!1),[n,l]=x(""),i=async()=>{s(!0),l("");try{await w.serverLaunch()}catch{}let o=0;const c=setInterval(async()=>{o++;try{await w.serverStatus(),clearInterval(c),window.location.reload()}catch{o>30&&(clearInterval(c),l("Server did not come back after restart. Check Docker logs."),s(!1))}},2e3)};if(t)return e("div",{class:"text-center py-12",children:[e("div",{class:"inline-block w-8 h-8 border-4 border-indigo-400 border-t-transparent rounded-full animate-spin mb-4"}),e("h3",{class:"text-xl font-semibold mb-2",children:"Launching Server..."}),e("p",{class:"text-slate-400",children:"The server is restarting with your imported database."})]});const r=window.location.hostname;return e("div",{class:"text-center py-12",children:[e("div",{class:"text-4xl mb-4 text-green-400",children:"✓"}),e("h3",{class:"text-xl font-semibold mb-2",children:"Database Committed"}),e("p",{class:"text-slate-400 mb-6",children:"The database has been written to disk and is ready to go."}),n&&e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-3 mb-4 text-red-300 text-sm inline-block",children:n}),e("div",{class:"mb-6",children:e("button",{onClick:i,class:"px-6 py-2 bg-green-600 hover:bg-green-500 text-white rounded transition-colors",children:"Launch Server"})}),e("div",{class:"bg-slate-800 rounded p-4 text-left max-w-md mx-auto text-sm",children:[e("h4",{class:"text-slate-400 text-xs uppercase tracking-wider mb-2",children:"After launch, connect via:"}),e("div",{class:"space-y-1",children:[e("div",{children:[e("span",{class:"text-slate-500",children:"Telnet:"})," ",e("code",{class:"text-cyan-300",children:["telnet ",r," 6886"]})]}),e("div",{children:[e("span",{class:"text-slate-500",children:"MU* Client:"})," ",e("span",{class:"text-slate-300",children:[r," port 6886"]})]}),e("div",{children:[e("span",{class:"text-slate-500",children:"God Login:"})," ",e("code",{class:"text-cyan-300",children:"connect Wizard <password>"})]}),e("p",{class:"text-slate-500 text-xs mt-2",children:"Password set via MUSH_GODPASS env variable."})]})]})]})}function Nt(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`}function Rt({onComplete:t}){const[s,n]=x("welcome"),[l,i]=x(""),[r,o]=x(!1),[c,h]=x(!1),d=async()=>{o(!0),i("");try{await w.createNewDB(),h(!0),n("ready")}catch(u){i(u.message)}finally{o(!1)}},p=async()=>{n("launching"),i("");try{await w.serverLaunch(),setTimeout(()=>a(),2e3)}catch{setTimeout(()=>a(),2e3)}},a=()=>{let u=0;const m=setInterval(async()=>{u++;try{const C=await fetch("/health");C.ok&&(await C.json()).game_running&&(clearInterval(m),t())}catch{u>30&&(clearInterval(m),i("Server did not come back after restart. Check Docker logs."),n("ready"))}},2e3)},_=["welcome","config","database","ready"];return e("div",{class:"max-w-2xl mx-auto",children:[e("div",{class:"text-center mb-8",children:[e("h1",{class:"text-3xl font-bold text-indigo-400 mb-2",children:K.appName}),e("p",{class:"text-slate-400",children:"Setup Wizard"})]}),e("div",{class:"flex items-center justify-center gap-4 mb-8",children:_.map((u,m)=>e("div",{class:"flex items-center gap-2",children:[m>0&&e("div",{class:"w-8 h-px bg-slate-600"}),e("div",{class:`w-8 h-8 rounded-full flex items-center justify-center text-sm ${s===u||s==="launching"&&u==="ready"?"bg-indigo-600 text-white":Oe(s)>m?"bg-green-600 text-white":"bg-slate-700 text-slate-400"}`,children:Oe(s)>m?"✓":m+1})]},u))}),l&&e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-3 mb-4 text-red-300 text-sm",children:[l,e("button",{onClick:()=>i(""),class:"ml-2 text-red-400 hover:text-red-300",children:"×"})]}),s==="welcome"&&e("div",{class:"bg-slate-800 rounded-lg p-8 text-center",children:[e("h2",{class:"text-xl font-semibold mb-4",children:["Welcome to ",K.appName]}),e("p",{class:"text-slate-400 mb-6",children:"This wizard will help you configure your MUSH server and set up your game database."}),e("button",{onClick:()=>n("config"),class:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded transition-colors",children:"Get Started"})]}),s==="config"&&e("div",{class:"bg-slate-800 rounded-lg p-8",children:[e("h2",{class:"text-xl font-semibold mb-4",children:"Configuration"}),e("p",{class:"text-slate-400 mb-4",children:"Your game configuration (game.yaml) contains server settings like port, name, and features. A default configuration will be created automatically. You can customize it later from the Config page."}),e("div",{class:"flex gap-3",children:[e("button",{onClick:()=>n("database"),class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors",children:"Continue"}),e("button",{onClick:()=>n("database"),class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-sm transition-colors",children:"Skip"})]})]}),s==="database"&&e("div",{class:"bg-slate-800 rounded-lg p-8",children:[e("h2",{class:"text-xl font-semibold mb-4",children:"Game Database"}),e("p",{class:"text-slate-400 mb-6",children:"Choose how to set up your game database:"}),e("div",{class:"space-y-3 mb-6",children:[e("button",{onClick:d,disabled:r,class:"w-full text-left p-4 bg-indigo-600/20 border border-indigo-500/40 rounded-lg hover:bg-indigo-600/30 transition-colors disabled:opacity-50",children:[e("div",{class:"text-indigo-300 font-semibold mb-1",children:r?"Creating...":"New Database (Recommended)"}),e("div",{class:"text-slate-400 text-sm",children:"Start fresh with an empty world. Creates Room Zero, Master Room, and the God (Wizard) player."})]}),e("button",{onClick:()=>{n("ready")},class:"w-full text-left p-4 bg-slate-700/50 border border-slate-600 rounded-lg hover:bg-slate-700 transition-colors",children:[e("div",{class:"text-slate-200 font-semibold mb-1",children:"Import from Backup"}),e("div",{class:"text-slate-400 text-sm",children:"Upload a TinyMUSH flatfile (.FLAT) or archive (.tar.gz, .zip) with your existing game data. Use the Import page from the sidebar after setup."})]})]})]}),s==="ready"&&e("div",{class:"bg-slate-800 rounded-lg p-8",children:c?e(j,{children:[e("div",{class:"text-center",children:[e("div",{class:"text-4xl mb-4 text-green-400",children:"✓"}),e("h2",{class:"text-xl font-semibold mb-2",children:"Database Created"}),e("p",{class:"text-slate-400 mb-6",children:"Your new game world is ready with Room Zero, Master Room, and the Wizard player. Seed files (text, dict, config, aliases) have been copied to the data directory."})]}),e("div",{class:"bg-slate-900 rounded p-4 mb-6 text-sm",children:[e("h4",{class:"text-slate-400 text-xs uppercase tracking-wider mb-2",children:"After Launch"}),e("div",{class:"space-y-1 text-slate-300",children:[e("div",{children:[e("span",{class:"text-slate-500",children:"Telnet:"})," ",e("code",{class:"text-cyan-300",children:["telnet ",window.location.hostname," 6886"]})]}),e("div",{children:[e("span",{class:"text-slate-500",children:"MU* Client:"})," ",window.location.hostname," port 6886"]}),e("div",{children:[e("span",{class:"text-slate-500",children:"Web Client:"})," ",e("code",{class:"text-cyan-300",children:["http://",window.location.hostname,":8443/"]})]}),e("div",{class:"mt-2 pt-2 border-t border-slate-700",children:[e("span",{class:"text-slate-500",children:"God Login:"})," ",e("code",{class:"text-cyan-300",children:"connect Wizard <password>"})]}),e("p",{class:"text-slate-500 text-xs mt-1",children:["God password is set via MUSH_GODPASS in docker-compose.yml. Change it in-game: ",e("code",{children:"@password <old>=<new>"})]})]})]}),e("div",{class:"flex gap-3 justify-center",children:[e("button",{onClick:p,class:"px-6 py-2 bg-green-600 hover:bg-green-500 text-white rounded transition-colors",children:"Launch Server"}),e("button",{onClick:t,class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-sm transition-colors",children:"Go to Dashboard First"})]})]}):e(j,{children:e("div",{class:"text-center",children:[e("h2",{class:"text-xl font-semibold mb-4",children:"Setup Complete"}),e("p",{class:"text-slate-400 mb-6",children:"You can import a game database from the Import page, or create a new one. Use the sidebar to navigate to the Import page when ready."}),e("button",{onClick:t,class:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded transition-colors",children:"Go to Dashboard"})]})})}),s==="launching"&&e("div",{class:"bg-slate-800 rounded-lg p-8 text-center",children:[e("div",{class:"mb-4",children:e("div",{class:"inline-block w-8 h-8 border-4 border-indigo-400 border-t-transparent rounded-full animate-spin"})}),e("h2",{class:"text-xl font-semibold mb-4",children:"Launching Server..."}),e("p",{class:"text-slate-400",children:"The server is restarting with your new database. This may take a few seconds."})]})]})}function Oe(t){return["welcome","config","database","ready"].indexOf(t)}function Ht({onLogin:t}){const[s,n]=x(""),[l,i]=x(""),[r,o]=x(!1),c=async h=>{h.preventDefault(),o(!0),i("");try{const d=await w.authLogin(s);t(d.default_password)}catch(d){i(d.message||"Login failed")}finally{o(!1)}};return e("div",{class:"min-h-screen flex items-center justify-center bg-slate-900",children:e("div",{class:"bg-slate-800 rounded-lg p-8 w-full max-w-sm",children:[e("div",{class:"text-center mb-6",children:[e("h1",{class:"text-2xl font-bold text-indigo-400",children:K.appName}),e("p",{class:"text-sm text-slate-400 mt-1",children:"Admin Panel"})]}),e("form",{onSubmit:c,children:[e("div",{class:"mb-4",children:[e("label",{class:"block text-sm text-slate-400 mb-1",children:"Password"}),e("input",{type:"password",value:s,onInput:h=>n(h.target.value),class:"w-full px-3 py-2 bg-slate-900 border border-slate-600 rounded text-slate-200 focus:outline-none focus:border-indigo-500",placeholder:"Enter admin password",autoFocus:!0})]}),l&&e("div",{class:"bg-red-500/10 border border-red-500/30 rounded p-2 mb-4 text-red-300 text-sm",children:l}),e("button",{type:"submit",disabled:r||!s,class:"w-full px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors disabled:opacity-50",children:r?"Logging in...":"Login"})]}),e("p",{class:"text-xs text-slate-500 text-center mt-4",children:"Default password: goTinyMush"})]})})}function Gt(){const[t,s]=x("dashboard"),[n,l]=x(!1),[i,r]=x(null),[o,c]=x(!1);B(()=>{vt(()=>r(!1)),w.authStatus().then(a=>{r(a.authenticated),a.authenticated&&a.default_password&&c(!0)}).catch(()=>r(!1))},[]),B(()=>{i&&w.setupStatus().then(a=>{a.setup_mode&&(l(!0),s("setup"))}).catch(()=>{})},[i]);const h=a=>{r(!0),a&&c(!0)},d=async()=>{await w.authLogout().catch(()=>{}),r(!1)};return i===null?e("div",{class:"min-h-screen flex items-center justify-center bg-slate-900 text-slate-400",children:"Loading..."}):i?e(bt,{currentPage:t,onNavigate:s,setupMode:n,onLogout:d,children:[o&&e("div",{class:"bg-amber-500/10 border border-amber-500/30 rounded p-3 mb-4 text-amber-300 text-sm flex items-center justify-between",children:[e("span",{children:"You are using the default admin password. Change it in the admin settings for security."}),e("button",{onClick:()=>c(!1),class:"text-amber-400 hover:text-amber-300 ml-2",children:"×"})]}),(()=>{switch(t){case"dashboard":return e($e,{});case"import":return e(At,{});case"config":return e(Ze,{});case"setup":return e(Rt,{onComplete:()=>{l(!1),s("dashboard")}});default:return e($e,{})}})()]}):e(Ht,{onLogin:h})}ut(e(Gt,{}),document.getElementById("app"));
